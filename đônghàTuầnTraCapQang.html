<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LỊCH TUẦN TRA CQ ĐÀI ĐHA</title>

<link rel="stylesheet" href="data/reset.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="Navigation/Navigation.css">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">

  <script>
  if (document.location.search.match(/type=embed/gi)) {
    window.parent.postMessage("resize", "*");
  }
</script>
<head>
<style>

/* suggested */

* {
  box-sizing: border-box;
}
/*the container must be positioned relative:*/
.autocomplete {
  position: relative;
  display: inline-block;
}

input {
  border: 1px solid transparent;
  background-color: #f1f1f1;
  padding: 10px;
  font-size: 16px;
}

input[type=text] {
  background-color: #f1f1f1;
  width: 100%;
}

input[type=submit] {
  background-color: DodgerBlue;
  color: #fff;
  cursor: pointer;
}

.autocomplete-items {
  position: absolute;
  border: 1px solid #d4d4d4;
  border-bottom: none;
  border-top: none;
  z-index: 99;
  /*position the autocomplete items to be the same width as the container:*/
  top: 100%;
  left: 0;
  right: 0;
}

.autocomplete-items div {
  padding: 10px;
  cursor: pointer;
  background-color: #fff; 
  border-bottom: 1px solid #d4d4d4; 
}

/*when hovering an item:*/
.autocomplete-items div:hover {
  background-color: #e9e9e9; 
}

/*when navigating through the items using the arrow keys:*/
.autocomplete-active {
  background-color: DodgerBlue !important; 
  color: #ffffff; 
}

/* End suggested */


.button {
  background-color:#006699;
  border: none;
  color:white;
  padding: 1px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 15px;
  margin: 3px 1px;
  cursor: pointer;
  
}

.button1 {border-radius: 10em;}




 body {
 overscroll-behavior-y: contain;                 /* https://usefulangle.com/post/278/html-disable-pull-to-refresh-with-css */
    font-family: sans-serif;
    -webkit-text-size-adjust: 100%;
    -ms-text-size-adjust: 100%
    color: #666;
    font: 90%/180% Arial, Helvetica, sans-serif;
    width:100%;
    max-width:100%;
    margin: 0 auto;
	
	background-image:white);
}

/* TABLE */
.HorizontalTable {
      width: 30%;
      overflow-x: scroll;
      overflow-y:hidden;
    }

.HorizontalTable {height: 20px; }
.Horizontal {
      width:1000px;
      height: 20px;
    }

.mytable table{
    border-collapse: collapse;
	display: block;
	width:auto;
	height: 800px;
	overflow: scroll;
	margin:0 auto;
  text-align: left;
  position: relative;
	
}


.mytable table th { /* Multicolored border */
    border: 1px solid red;
	text-align: center;
}


.mytable table td { /* Multicolored border */
    border: 1px solid;
    border-color: #f00 #0f0 #00f #f0f;
	text-align: left;
}


.mytable table tr:hover td {
    background: #85c1e9;
} 


.mytable thead tr#row3 th {
  cursor: pointer;
  font-weight: bold;
	position: sticky;
	top: 0;
	background: #154360;
	color:white;
	text-transform: capitalize;
	vertical-align: baseline;
	white-space: nowrap;
   padding: 1px;
   border: 1px solid red;
}


.mytable thead tr#row3 th:hover {
  color:white;
 cursor: pointer;
}

.mytable thead tr#row3 th:hover::after {
  color: white;
  font-size: 1.2em;
  content: ' \025B8';
}

.mytable thead tr#row3 th::after {
  font-size: 1.2em;
  color: transparent;
  content: ' \025B8';
} 

/* fixed table header and first two columns   https://stackoverflow.com/questions/53499803/make-table-header-and-first-two-columns-fixed  */

.mytable thead tr#row3 :first-child {
  position:sticky;
  left:0;
  z-index:20;
  background-color:#006699;
    border: 1px solid;
    border-color: #f00 #0f0 #00f #f0f;
    text-align: center
}


.mytable td:first-child {
  position:sticky;
  left:0;
  z-index:20;
  background-color:white;
    border: 1px solid;
    border-color: #f00 #0f0 #00f #f0f;
   text-align: center
}


.mytable thead tr#row3 th:nth-child(2)  { 
position:sticky;
  left:50px;
  z-index:20;
  background-color:#006699;
    border: 1px solid;
    border-color: #f00 #0f0 #00f #f0f;
    text-align: center
  }

.mytable td:nth-child(2)  { 
position:sticky;
  left:50px;
  z-index:20;
  background-color: #f8f9f9;
    border: 1px solid;
    border-color: #f00 #0f0 #00f #f0f;
    text-align: center
  }  

.mytable thead tr#row3 th:nth-child(3)  { 
position:sticky;
  left:126px;
  z-index:20;
  background-color:#006699;
    border: 1px solid;
    border-color: #f00 #0f0 #00f #f0f;
    text-align: center
  }

.mytable td:nth-child(3)  { 
position:sticky;
  left:126px;
  z-index:20;
  background-color:white;
    border: 1px solid;
    border-color: #f00 #0f0 #00f #f0f;
    text-align: center
  }  
  
.mytable thead tr#row3 th:first-child , .mytable thead tr#row3 th:nth-child(2), .mytable thead tr#row3 th:nth-child(3) {
  z-index:31
  }
/* END TABLE */



.pagination {
    display: inline-block;
    padding-left: 0;
    margin: 15px 0;
    border-radius: 4px
}

.pagination>li {
    display: inline
}

.pagination>li>a,
.pagination>li>span {
    position: relative;
    float: left;
    padding: 2px 10px;
    margin-left: -1px;
    line-height: 1.42857143;
    color: #337ab7;
    text-decoration: none;
    background-color: #fff;
    border: 1px solid #ddd
}

.pagination>li:first-child>a,
.pagination>li:first-child>span {
    margin-left: 0;
    border-top-left-radius: 4px;
    border-bottom-left-radius: 4px
}

.pagination>li:last-child>a,
.pagination>li:last-child>span {
    border-top-right-radius: 4px;
    border-bottom-right-radius: 4px
}

.pagination>li>a:focus,
.pagination>li>a:hover,
.pagination>li>span:focus,
.pagination>li>span:hover {
    z-index: 2;
    color: #23527c;
    background-color: #eee;
    border-color: #ddd
}

.pagination>.active>a,
.pagination>.active>a:focus,
.pagination>.active>a:hover,
.pagination>.active>span,
.pagination>.active>span:focus,
.pagination>.active>span:hover {
    z-index: 3;
    color: #fff;
    cursor: default;
    background-color: #337ab7;
    border-color: #337ab7
}

.pagination>.disabled>a,
.pagination>.disabled>a:focus,
.pagination>.disabled>a:hover,
.pagination>.disabled>span,
.pagination>.disabled>span:focus,
.pagination>.disabled>span:hover {
    color: #777;
    cursor: not-allowed;
    background-color: #fff;
    border-color: #ddd
}

.pagination-lg>li>a,
.pagination-lg>li>span {
    padding: 10px 16px;
    font-size: 18px;
    line-height: 1.3333333
}
.pagination li:hover{
    cursor: pointer;
}

select.form-control {
  height: 28px;
}




.footer {
 background-image: linear-gradient(to bottom right, #5dade2 ,#ffffb3, #5dade2 ,#ffffb3 ,#ffffb3);

  width: 100%;
  text-align: left;
  font-family: sans-serif;
  font-weight: bold;
  font-size: 16px;
  padding: 5px;
  margin-top: 5px;
  
}

.footer .footer-left,
.footer .footer-center,
.footer .footer-right {
  display: inline-block;
  vertical-align: top;
}




.footer .footer-left {
  width: 33%;
  padding-right: 5px;
}

.footer .about {
  line-height: 20px;
  color:black;
  font-size: 16px;
  font-weight: bold;
  margin: 0;
}

.footer .about span {
  display: block;
  color:black;
  font-size: 14px;
  font-weight: bold;
  margin-bottom: 20px;
}

.footer .icons {
  margin-top: 20px;
}

.footer .icons a {
  display: inline-block;
  width: 25px;
  height: 25px;
  cursor: pointer;
  background-color:#0099ff;
  border-radius: 2px;
  font-size: 20px;
  color: #ffffff;
  text-align: center;
  line-height: 10px;
  margin-right: 3px;

}




.footer .footer-center {
  width: 25%;
}

.footer .footer-center i {
  background-color:#0099ff;
  color: #ffffff;
  font-size: 25px;
  width: 38px;
  height: 20px;
  border-radius: 50%;
  text-align: center;
  line-height: 10px;
  margin: 10px 3px;
  vertical-align: middle;
}

.footer .footer-center i.fa-envelope {
  font-size: 17px;
  line-height: 25px;
  color: #ffffff;
}

.footer .footer-center p {
  display: inline-block;
  color:black;
  vertical-align: middle;
  margin: 0;
}

.footer .footer-center p span {
  display: block;
  font-weight: normal;
  font-size: 14px;
  line-height: 2;
}

.footer .footer-center p a {
  color: #0099ff;
  text-decoration: none;
}




.footer .footer-right {
  width: 35%;
}

.footer h2 {
  color: #ffffff;
  font-size: 26px;
  font-weight: normal;
  margin: 0;
}

.footer h2 span {
  color: #0099ff;
}

.footer .menu {
  color:black;
  margin: 0px 0 12px;
  padding: 0;
}

.footer .menu a {
  display: inline-block;
  line-height: 1.0;
  text-decoration: none;
  color: inherit;
}

.footer .menu a:hover {
  color: #0099ff;
}

.footer .name {
  color:black;
  font-size: 14px;
  font-weight: bold;
  margin: 0;
}



.input1 {border-radius: 12px;}

fieldset {

background-image: linear-gradient(to bottom right, #5dade2 ,#ffffb3, #5dade2 ,#ffffb3 ,#ffffb3);

display: block;

left: 0;
max-width:100%;

}

fieldset:focus-within {
  background-image: linear-gradient(to bottom right, #5dade2 ,#ffffb3, #5dade2 ,#ffffb3 ,#ffffb3);

}



legend{
width:250px;
height:28px;
text-align: center;
font-size: 16px; 
font-weight:  bold;
color: white;
padding: 2px 2px ;

box-shadow: 0 0 0 2px #ddd;
font: time new roman;
 background-color: #006699;
border-radius: 10em;
}






form .question {
  position: relative;
  padding: 10px 4px;
  display:inline-block;
}
form .question:first-of-type {
  padding-top: 0;
}
form .question:last-of-type {
  padding-bottom: 0;
}
form .question label {
  transform-origin: left center;
  color: #0e3753;
  font-weight: 700;
  letter-spacing: 0.01em;
  font-size: 14px;
  box-sizing: border-box;
  padding: 8px 17px;
  display: block;
  position: absolute;
  margin-top: -35px;
  z-index: 2;
  pointer-events: none;
}


.question .id {
	width:100%;
	min-height:40px;
	}
 .question .Colum2 {
	width:100%;
	min-height:40px;
	}
 .question .Colum3 {
	width:100%;
	min-height:40px;
	}
 .question .Colum4 {
	width:100%;
	min-height:40px;
	}
 .question .Colum5 {
	width:100%;
	min-height:40px;
	}
 .question .Colum6 {
	width:100%;
	min-height:40px;
	}
 .question .Colum7 {
	width:100%;
	min-height:40px;
	}
 .question .Colum8 {
	width:100%;
	min-height:40px;
	}
 .question .Colum9 {
	width:100%;
	min-height:40px;
	}
 .question .Colum10 {
	width:100%;
	min-height:40px;
	}
	.question .Colum11 {
	width:100%;
	min-height:40px;
	}
 .question .Colum12 {
	width:100%;
	min-height:40px;
	}
 .question .Colum13 {
	width:100%;
	min-height:40px;
	}
 .question .Colum14 {
	width:100%;
	min-height:40px;
	}
 .question .Colum15 {
	width:100%;
	min-height:40px;
	}
 .question .Colum16 {
	width:100%;
	min-height:40px;
	}
	


@media (max-width: 380px) {
  .footer {
    font-size: 14px;
  }
  .footer .footer-left,
  .footer .footer-center,
  .footer .footer-right {
    display: block;
    width: 100%;
    margin-bottom: 40px;
    text-align: left;
  }
  .footer .footer-center i {
    margin-left: 3px;
  }

  .question .id {
	width:122px;
	min-height:40px;
	}
 .question .Colum2 {
	width:122px;
	min-height:40px;
	}
.question .Colum3 {
	width:122px;
	min-height:40px;
	}

.question .Colum4 {
	width:122px;
	min-height:40px;
	}
 .question .Colum5 {
	width:122px;
	min-height:40px;
	}
 .question .Colum6 {
	width:122px;
	min-height:40px;
	}
 .question .Colum7 {
	width:122px;
	min-height:40px;
	}
 .question .Colum8 {
	width:122px;
	min-height:40px;
	}
 .question .Colum9 {
	width:122px;
	min-height:40px;
	}
 .question .Colum10 {
	width:122px;
	min-height:40px;
	}
.question .Colum11 {
	width:122px;
	min-height:40px;
	}
 .question .Colum12 {
	width:122px;
	min-height:40px;
	}
 .question .Colum13 {
	width:122px;
	min-height:40px;
	}
 .question .Colum14 {
	width:122px;
	min-height:40px;
	}
 .question .Colum15 {
	width:122px;
	min-height:40px;
	}	

 .question .Colum16 {
	width:122px;
	min-height:40px;
	} 

}


@media (max-width: 600px) {
  .footer {
    font-size: 14px;
  }
  .footer .footer-left,
  .footer .footer-center,
  .footer .footer-right {
    display: block;
    width: 100%;
    margin-bottom: 40px;
    text-align: left;
  }
  .footer .footer-center i {
    margin-left: 3px;
  }

  .question .id {
	width:152px;
	min-height:40px;
	}
 .question .Colum2 {
	width:152px;
	min-height:40px;
	}
.question .Colum3 {
	width:152px;
	min-height:40px;
	}

.question .Colum4 {
	width:152px;
	min-height:40px;
	}
 .question .Colum5 {
	width:152px;
	min-height:40px;
	}
 .question .Colum6 {
	width:152px;
	min-height:40px;
	}
 .question .Colum7 {
	width:152px;
	min-height:40px;
	}
 .question .Colum8 {
	width:152px;
	min-height:40px;
	}
 .question .Colum9 {
	width:152px;
	min-height:40px;
	}
 .question .Colum10 {
	width:152px;
	min-height:40px;
	}
.question .Colum11 {
	width:152px;
	min-height:40px;
	}
 .question .Colum12 {
	width:152px;
	min-height:40px;
	}
 .question .Colum13 {
	width:152px;
	min-height:40px;
	}
 .question .Colum14 {
	width:152px;
	min-height:40px;
	}
 .question .Colum15 {
	width:152px;
	min-height:40px;
	}	

 .question .Colum16 {
	width:152px;
	min-height:40px;
	} 
	
}



.popup {
  width: 80%;
  padding: 15px;
  left: 0;
  margin-left: 5%;
  border: 1px solid rgb(1,82,73);
  border-radius: 10px;
  color: rgb(1,82,73);
  background: white;
  position: absolute;
  top: 25%;
  box-shadow: 5px 5px 5px #000;
  z-index: 10001;
  font-weight: 700;
  text-align: center;
}

.Thoat {
  position: fixed;
  width: 100%;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: transparent;
  z-index: 10000;
  display :none;
}

@media (min-width: 768px) {
  .popup {
    width: 66.66666666%;
    margin-left: 16.666666%;
  }
}
@media (min-width: 992px) {
  .popup {
    width: 80%;
    margin-left: 25%;
  }
}
@media (min-width: 1200px) {
  .popup {
    width: 33.33333%;
    margin-left: 33.33333%;
  }
}

.dialog-btn {
  background-color:#006699;
  color: white;
  font-weight: 700;
  border: 1px solid #44B78B;
  border-radius: 10px;
  height: 30px;
  width: 30%;
}
.dialog-btn:hover {
  background-color:#015249;
  cursor: pointer;
}



#btn-show-dialog {
  background-color:#006699;
  border: none;
  color:white;
  padding: 1px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 17px;
  margin: 3px 1px;
  cursor: pointer;
    height: 30px;
  width: 90px;
  font-weight: bold;
}

#btn-show-dialog {border-radius: 12px;}




.popup_time {
  width: 80%;
  padding: 15px;
  left: 0;
  margin-left: 5%;
  border: 1px solid rgb(1,82,73);
  border-radius: 10px;
  color: rgb(1,82,73);
  background: white;
  position: absolute;
  top: 25%;
  box-shadow: 5px 5px 5px #000;
  z-index: 10001;
  font-weight: 700;
  text-align: center;
}

.Thoat_time {
  position: fixed;
  width: 100%;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: transparent;
  z-index: 10000;
  display :none;
}

@media (min-width: 768px) {
  .popup_time {
    width: 66.66666666%;
    margin-left: 16.666666%;
  }
}
@media (min-width: 992px) {
  .popup_time {
    width: 80%;
    margin-left: 25%;
  }
}
@media (min-width: 1200px) {
  .popup_time {
    width: 33.33333%;
    margin-left: 33.33333%;
  }
}



.popup_update {
  width: 80%;
  padding: 15px;
  left: 0;
  margin-left: 5%;
  border: 1px solid rgb(1,82,73);
  border-radius: 10px;
  color: rgb(1,82,73);
  background: white;
  position: absolute;
  top: 15%;
  box-shadow: 5px 5px 5px #000;
  z-index: 10001;
  font-weight: 700;
  text-align: center;
}

.Thoat_update {
  position: fixed;
  width: 100%;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: transparent;
  z-index: 10000;
  display :none;
}

@media (min-width: 768px) {
  .popup_update {
    width: 66.66666666%;
    margin-left: 16.666666%;
  }
}
@media (min-width: 992px) {
  .popup_update {
    width: 80%;
    margin-left: 25%;
  }
}
@media (min-width: 1200px) {
  .popup_update {
    width: 33.33333%;
    margin-left: 33.33333%;
  }
}

.update-btn {
  background-color:#006699;
  color: white;
  font-weight: 700;
  border: 1px solid #44B78B;
  border-radius: 10px;
  height: 30px;
  width: 30%;
}
.update-btn:hover {
  background-color:#015249;
  cursor: pointer;
}

/* TRANS */

.popup_trans {
  width: 80%;
  padding: 15px;
  left: 0;
  margin-left: 5%;
  border: 1px solid rgb(1,82,73);
  border-radius: 10px;
  color: rgb(1,82,73);
  background: white;
  position: absolute;
  top: 15%;
  box-shadow: 5px 5px 5px #000;
  z-index: 10001;
  font-weight: 700;
  text-align: center;
}

.Thoat_trans {
  position: fixed;
  width: 100%;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: transparent;
  z-index: 10000;
  display :none;
}

@media (min-width: 768px) {
  .popup_trans {
    width: 66.66666666%;
    margin-left: 16.666666%;
  }
}
@media (min-width: 992px) {
  .popup_trans {
    width: 80%;
    margin-left: 25%;
  }
}
@media (min-width: 1200px) {
  .popup_trans {
    width: 33.33333%;
    margin-left: 33.33333%;
  }
}

.trans-btn {
  background-color:#006699;
  color: white;
  font-weight: 700;
  border: 1px solid #44B78B;
  border-radius: 10px;
  height: 30px;
  width: 30%;
}
.trans-btn:hover {
  background-color:#015249;
  cursor: pointer;
}

/*END TRANS */


.popup_insert {
  width: 80%;
  padding: 15px;
  left: 0;
  margin-left: 5%;
  border: 1px solid rgb(1,82,73);
  border-radius: 10px;
  color: rgb(1,82,73);
  background: white;
  position: absolute;
  top: 15%;
  box-shadow: 5px 5px 5px #000;
  z-index: 10001;
  font-weight: 700;
  text-align: center;
}

.Thoat_insert {
  position: fixed;
  width: 100%;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: transparent;
  z-index: 10000;
  display :none;
}

@media (min-width: 768px) {
  .popup_insert {
    width: 66.66666666%;
    margin-left: 16.666666%;
  }
}
@media (min-width: 992px) {
  .popup_insert {
    width: 80%;
    margin-left: 25%;
  }
}
@media (min-width: 1200px) {
  .popup_insert {
    width: 33.33333%;
    margin-left: 33.33333%;
  }
}

.insert-btn {
  background-color:#006699;
  color: white;
  font-weight: 700;
  border: 1px solid #44B78B;
  border-radius: 10px;
  height: 30px;
  width: 30%;
}
.insert-btn:hover {
  background-color:#015249;
  cursor: pointer;
}

.popup_delete {
  width: 80%;
  padding: 15px;
  left: 0;
  margin-left: 5%;
  border: 1px solid rgb(1,82,73);
  border-radius: 10px;
  color: rgb(1,82,73);
  background: white;
  position: absolute;
  top: 15%;
  box-shadow: 5px 5px 5px #000;
  z-index: 10001;
  font-weight: 700;
  text-align: center;
}

.Thoat_delete {
  position: fixed;
  width: 100%;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: transparent;
  z-index: 10000;
  display :none;
}

@media (min-width: 768px) {
  .popup_delete {
    width: 66.66666666%;
    margin-left: 16.666666%;
  }
}
@media (min-width: 992px) {
  .popup_delete {
    width: 80%;
    margin-left: 25%;
  }
}
@media (min-width: 1200px) {
  .popup_delete {
    width: 33.33333%;
    margin-left: 33.33333%;
  }
}

.delete-btn {
  background-color:#006699;
  color: white;
  font-weight: 700;
  border: 1px solid #44B78B;
  border-radius: 10px;
  height: 30px;
  width: 30%;
}
.delete-btn:hover {
  background-color:#015249;
  cursor: pointer;
}


.popup_id {
  width: 80%;
  padding: 15px;
  left: 0;
  margin-left: 5%;
  border: 1px solid rgb(1,82,73);
  border-radius: 10px;
  color: rgb(1,82,73);
  background: white;
  position: absolute;
  top: 15%;
  box-shadow: 5px 5px 5px #000;
  z-index: 10001;
  font-weight: 700;
  text-align: center;
}

.Thoat_id {
  position: fixed;
  width: 100%;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: transparent;
  z-index: 10000;
  display :none;
}

@media (min-width: 768px) {
  .popup_id {
    width: 66.66666666%;
    margin-left: 16.666666%;
  }
}
@media (min-width: 992px) {
  .popup_id {
    width: 80%;
    margin-left: 25%;
  }
}
@media (min-width: 1200px) {
  .popup_id {
    width: 33.33333%;
    margin-left: 33.33333%;
  }
}


.popup_result {
  width: 80%;
  padding: 15px;
  left: 0;
  margin-left: 5%;
  border: 1px solid rgb(1,82,73);
  border-radius: 10px;
  color: rgb(1,82,73);
  background: white;
  position: absolute;
  top: 25%;
  box-shadow: 5px 5px 5px #000;
  z-index: 10001;
  font-weight: 700;
  text-align: center;
}

.Thoat_result {
  position: fixed;
  width: 100%;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: transparent;
  z-index: 10000;
  display :none;
}

@media (min-width: 768px) {
  .popup_result {
    width: 66.66666666%;
    margin-left: 16.666666%;
  }
}
@media (min-width: 992px) {
  .popup_result {
    width: 80%;
    margin-left: 25%;
  }
}
@media (min-width: 1200px) {
  .popup_result {
    width: 33.33333%;
    margin-left: 33.33333%;
  }
}



.id-btn {
  background-color:#006699;
  color: white;
  font-weight: 700;
  border: 1px solid #44B78B;
  border-radius: 10px;
  height: 30px;
  width: 30%;
}
.id-btn:hover {
  background-color:#015249;
  cursor: pointer;
}


/* Lịch */

.datepicker-dropdown {
  position: absolute;
  top: 100%;
  left: 0;
  z-index: 999;
  display: none;
  padding: 4px;
  margin-top: 1px;
  font-size: 14px;
  line-height: 1.428571429;
  color: #333;
  background-color: #fff;
  border: 1px solid #ccc;
  border-radius: 4px;
  -webkit-box-shadow: 0 6px 12px rgba(0, 0, 0, 0.176);
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.176);
}

/* End Lịch */
		
</style>

</head>


<body oncontextmenu="return false">


  <div class="header";>
  <!-- <img style=" width: 100%;" src="/Banner DHA New.png" />  -->
  <img style=" width: 100%;" src=  "https://www.dropbox.com/s/5yhuhsz9q5g18s1/Banner%20DHA%20New.png?raw=1" />   
  </div>



<p align="center" style="font-size: 1.8em; color: #000099; font-weight: bold">LỊCH TUẦN TRA CQ ĐÀI ĐHA</p>


&nbsp;&nbsp;&nbsp;&nbsp;<button id="btn-show-dialog">Thoát</button>

<div class="Thoat" id="dialog-container">
  <div class="popup">
    <p>Bạn có muốn Thoát không ?</p>
    <div class="text-right">
      <button class="dialog-btn btn-cancel" id="cancel">Cancel</button>
      <button class="dialog-btn btn-primary" id="confirm">OK</button>
    </div>
  </div>
</div>
<p id="testText"></p>

<div class="Thoat_time" id="dialog_time">
  <div class="popup_time">
    <p>Bạn phải Đăng nhập lại !!</p>
    <div class="text-right">
      <button class="dialog-btn btn-primary" id="confirm_time">OK</button>
    </div>
  </div>
</div>

<div class="Thoat_update" id="update-container">
  <div class="popup_update">
    <p>Bạn muốn Cập nhật không ?</p>
    <div class="text-right">
      <button class="update-btn btn-cancel" id="cancel_update">Cancel</button>
      <button class="update-btn btn-primary" id="confirm_update">OK</button>
    </div>
  </div>
</div>

<div class="Thoat_insert" id="insert-container">
  <div class="popup_insert">
    <p>Bạn có Thêm dòng số liệu không ?</p>
    <div class="text-right">
      <button class="insert-btn btn-cancel" id="cancel_insert">Cancel</button>
      <button class="insert-btn btn-primary" id="confirm_insert">OK</button>
    </div>
  </div>
</div>

<div class="Thoat_delete" id="delete-container">
  <div class="popup_delete">
    <p>Bạn muốn Xóa dòng số liệu không này ?</p>
    <div class="text-right">
      <button class="delete-btn btn-cancel" id="cancel_delete">Cancel</button>
      <button class="delete-btn btn-primary" id="confirm_delete">OK</button>
    </div>
  </div>
</div>

<div class="Thoat_id" id="id-container">
  <div class="popup_id">
    <p type = "text" id="id_alert" value=""></p>
    <div class="text-right">
      <button class="id-btn btn-primary" id="confirm_id">OK</button>
    </div>
  </div>
</div>


<div class="Thoat_result" id="dialog_result">
  <div class="popup_result">
    <p id="id_result" value=""></p>
    <div id="id_result1" class="text-right">
      <button class="dialog-btn btn-primary" id="confirm_result1">OK</button>
    </div>

    <div id="id_result2" class="text-right">
	  <button class="dialog-btn btn-primary" id="confirm_result2">OK</button>
    </div>	
	
 </div>
</div>


<form>
<fieldset>
<legend id ="legend" align="center"> Bảng cập nhật   </legend>

<P></p>

<div class="input" align="left">

<div align="right"><input class="input1"  name ="capnhatttcqDHA" id="capnhatttcqDHA" style="width:100px; height:26px; text-align: center; margin-right:40px; font-weight: bold; color: #ff0000" value="" readonly hidden></div>



  <div class="question">
  <label>STT</label>
    <textarea class="id" type="text" name ="id" id="id" style="height:30px"></textarea>
   </div>
   
 <div class="question">
   <label>Ngày</label>
    <textarea class="Colum2" type="date" name ="Colum2" id="Colum2" value="" style="height:30px" ></textarea>
  </div>
  
 <div class="question">
   <label>Trạm</label>
    <textarea class="Colum3" type="text" name ="Colum3" id="Colum3" value="" style="height:30px"></textarea>
  </div> 

 <div class="question">
   <label>Tuyến cáp</label>
    <textarea class="Colum4" type = "text" name ="Colum4" id="Colum4" value="" style="height:30px"></textarea>
  </div> 

 <div class="question">
   <label>Đơn vị GT</label>
    <textarea class="Colum5" type = "text" name ="Colum5" id="Colum5" value="" style="height:30px"></textarea>
  </div>

 <div class="question">
   <label>SĐT GT</label>
    <textarea class="Colum6" type = "text" name ="Colum6" id="Colum6" value="" style="height:30px"></textarea>
  </div>

 <div class="question">
    <label>Tên tuần tra</label>
    <textarea class="Colum7" type = "text" name ="Colum7" id="Colum7" style="height:30px"></textarea>
  </div>

 <div class="question">
   <label>SĐT tuần tra</label>
    <textarea class="Colum8" type = "text" name ="Colum8" id="Colum8" style="height:30px"></textarea>
  </div>

 <div  class="question">
   <label>Nội dung CV</label>
    <textarea class="Colum9" type = "text" name ="Colum9" id="Colum9" style="height:30px" ></textarea>
  </div>  


 
<div class="question2" align="center">
<p type = "text" id="ngay" readonly></p>
<p type = "text" id="ngay2" value="" readonly></p>


	<p align="center" id="re" style="font-size: 1.2em; color: red; font-weight: bold" hidden></p>
	
	
	<input type="button" class="button button1" id="btn-show-insert" value="Nhập mới" style="width:110px; height:30px; font-size: 15; font-weight: bold"/>
	<input type="button" class="button button1" id="btn-show-update" value="Cập nhật" style="width:110px; height:30px; font-size: 15; font-weight: bold"/>	
	<input type="button" class="button button1" id="btn-show-delete" value="Xóa" style="width:110px; height:30px; font-size: 15; font-weight: bold"/>

	
	
</div>
</div>
</fieldset>

</form>



<div align="center">


<br>

<div>
<textarea type="text" id="searchInput" onkeyup="searchTableWithHeader()" style="width:150px; height:23px; border-radius: 26px 26px 26px 26px; border: 1px solid;" placeholder="Tìm Kiếm"></textarea>
Số dòng: <span id="count"></span>
</div>




		<div align="center" class="container">
		
			<div class="pagination">            
            <li data-page="prev" ><span> < <span class="sr-only">(current)</span></span></li>
			
				&nbsp;<a>Dòng</a>
			 		<select class  ="form-control" name="state" id="maxRows">
						 <option value="5000000">Tất cả</option>
						 <option value="5">5</option>						 
						 <option value="10">10</option>
						 <option value="15">15</option>
						 <option value="20">20</option>
						 <option value="50">50</option>
						 <option value="70">70</option>
						 <option value="100">100</option>
						</select>			 		
			  	

			<li data-page="next" id="prev"><span> > <span class="sr-only">(current)</span></span></li>
			</div><button style="height:26px;" id="exportButton">Xuất Excel</button></div>


		
		
<div class="HorizontalTable">
<div class="Horizontal"></div>
</div>		
	
<div class = "mytable" id="showData"></div>
<div id="loader"></div>



		<div class="container">			
				<h2 id="devtools-state"></h2>
				<h3 id="devtools-orientation"></h3>	
		</div>	

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>

<script src="Export_Excel_Color/Export_Excel_Color.min.js"></script>
<script src="LinkGG.js"></script>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/locales/bootstrap-datepicker.vi.min.js"></script>


	
<script>
//https://stackoverflow.com/questions/8100770/auto-scaling-inputtype-text-to-width-of-value
function resizeInput() {
    $(this).attr('size', $(this).val().length);
}

$('input[type="text"]')
    // event handler
    .keyup(resizeInput)
    // resize on page load
    .each(resizeInput);
	
	
	
// Example starter JavaScript for disabling form submissions if there are invalid fields
(function () {
  'use strict'

  // Fetch all the forms we want to apply custom Bootstrap validation styles to
  var forms = document.querySelectorAll('.needs-validation')

  // Loop over them and prevent submission
  Array.prototype.slice.call(forms)
    .forEach(function (form) {
      form.addEventListener('submit', function (event) {
        if (!form.checkValidity()) {
          event.preventDefault()
          event.stopPropagation()
        }

        form.classList.add('was-validated')
      }, false)
    })
})()	
	
</script>

<script>
//https://www.w3schools.com/howto/tryit.asp?filename=tryhow_js_autocomplete
//https://www.computerhope.com/issues/ch001655.htm (How to combine or merge cells in an HTML table)
//========================================================
function myFunction1() {
  const previousRow = {};
  const colsChanged = {};
  let dark = false;

  Array.from(document.querySelectorAll('tbody tr')).forEach((tr, rowIdx) => {
    Array.from(tr.children).forEach((td, colIdx) => {
      if (rowIdx > 0 && previousRow[colIdx].text === td.innerText) {
        previousRow[colIdx].elem.setAttribute('rowspan', ++previousRow[colIdx].span);
        colsChanged[colIdx] = false;
        td.remove();
      } else {
        previousRow[colIdx] = { span: 1, text: td.innerText, elem: td, dark };
        colsChanged[colIdx] = true;
      }
    });
    const rowChanged = Object.values(colsChanged).every(Boolean);
    dark = rowChanged && rowIdx > 0 ? !dark : dark;
    if (dark) {
      tr.classList.add('dark');
    }
  });
}


//=============================================================================================================

// JavaScript
function autocomplete(inp, arr) {
  var currentFocus;

  inp.addEventListener("input", function(e) {
    var a, b, i, val = this.value;
    closeAllLists();

    if (!val) { return false; }
    currentFocus = -1;

    a = document.createElement("DIV");
    a.setAttribute("id", this.id + "autocomplete-list");
    a.setAttribute("class", "autocomplete-items");
    this.parentNode.appendChild(a);

    var matches = arr.filter(function(item) {
      return (
        item.toUpperCase().includes(val.toUpperCase())
      );
    });

    for (i = 0; i < matches.length; i++) {
      b = document.createElement("DIV");
      b.innerHTML = "<strong>" + matches[i] + "</strong>";
      b.innerHTML += "<input type='hidden' value='" + matches[i] + "'>";

      b.addEventListener("click", function(e) {
        inp.value = this.getElementsByTagName("input")[0].value;
        handleColumn7Click(e); // Thêm hàm xử lý click vào Column7
        closeAllLists();
      });

      a.appendChild(b);
    }
  });

  inp.addEventListener("keydown", function(e) {
      var x = document.getElementById(this.id + "autocomplete-list");
      if (x) x = x.getElementsByTagName("div");
      if (e.keyCode == 40) {
        /*If the arrow DOWN key is pressed,
        increase the currentFocus variable:*/
        currentFocus++;
        /*and and make the current item more visible:*/
        addActive(x);
      } else if (e.keyCode == 38) { //up
        /*If the arrow UP key is pressed,
        decrease the currentFocus variable:*/
        currentFocus--;
        /*and and make the current item more visible:*/
        addActive(x);
      } else if (e.keyCode == 13) {
        /*If the ENTER key is pressed, prevent the form from being submitted,*/
        e.preventDefault();
        if (currentFocus > -1) {
          /*and simulate a click on the "active" item:*/
          if (x) x[currentFocus].click();
        }
      }
  });

  function addActive(x) {
    if (!x) return false;
    removeActive(x);
    if (currentFocus >= x.length) currentFocus = 0;
    if (currentFocus < 0) currentFocus = (x.length - 1);
    x[currentFocus].classList.add("autocomplete-active");
  }

  function removeActive(x) {
    for (var i = 0; i < x.length; i++) {
      x[i].classList.remove("autocomplete-active");
    }
  }

  function closeAllLists(elmnt) {
    var x = document.getElementsByClassName("autocomplete-items");
    for (var i = 0; i < x.length; i++) {
      if (elmnt != x[i] && elmnt != inp) {
        x[i].parentNode.removeChild(x[i]);
      }
    }
  }

  document.addEventListener("click", function (e) {
    closeAllLists(e.target);
  });

  /* Sửa lại phần xử lý click vào Column7 */
  function handleColumn7Click(e) {
    var inputValue = e.target.innerText.trim();
    var phoneNumber = inputValue.match(/\d+$/); // Tách số điện thoại bằng regex
    var columnName7 = inputValue.replace(phoneNumber, '').trim();
    var columnName8 = phoneNumber[0]; // Lấy số điện thoại từ mảng phoneNumber

    document.getElementById("Colum7").value = columnName7;
    document.getElementById("Colum8").value = columnName8;
  }
}

/*An array containing all the country names in the world:*/
var Colum3 = ["DHI","DHA","HUE","HIEN(QC10)","ALI(QC9)","CLO(QC8)","R7(QC7)","BSN(QC6)"];
var Colum4 = ["QL1A Km 650 - Km700 (Bắc DHI)","QL1A Km 650 - Km700 (Nam DHI)","QL1A Km 700 - Km 757 (Bắc DHA)","QL1A Km 757 - Km 812 (Nam DHA)","QL1A Km 812 - Km 860 (Bắc HUE)","QL1A Km 860-894+400 và đường Laguna (Nam HUE)","HCM Km 398+500 - Km 412+500 (HIEN-ALI)","HCM Km 398+500 - Km 412+500 (HIEN-ALI)","HCM Km 343+163 - Km 398+500 (ALI-HIEN)","HCM Km 343+163- Km 277 (ALI-CLO)","HCM Km 1084- Km 277 (CLO-ALI)","HCM Km 1084 - Km 1020 (CLO-R7)","HCM Km 968 - Km 1020(R7-CLO)","HCM Km 968-km 913 (R7- BSN)","HCM Km 858 - Km 816 (BSN-R7)","HCM Km 858 - Km8 16 (BSN-HSN)"];
var Colum7 = ["Lê Văn Khanh 0916468333","Nguyễn Văn Phức 0914564818","Trần Xuân Thái 0942492777","Lê Văn Nhân 0913491620","Lê Văn Lợi 0916616357","Nguyễn Tiến Hoài 0913457847","Nguyễn Năm 0915388123","Nguyễn Thành Nam 0914178445","Nguyễn Đăng Quang 0912983454","Nguyễn Xuân Phong 0949234777","Phạm Minh Tuấn 0917382456","Hoàng Việt Cường 0913013939","Phan Nghĩa Bình 0912335757","Trần Quốc Tuấn 0941368099","Phan Trung Hiếu 0914245488","Trần Quốc Bảo 0913485365","Trương Việt Cường 0914012225","Hoàng Chính 0914729998","Huỳnh Anh Hùng 0948281444","Lê Đa Chánh 0946037482","Phan Văn Phong 0913469468","Dương Văn Quang 0914203262","Mai Trọng Khánh 0911348771","Lê Đa Ngọc 0918643668","Lê Anh Tuấn 0911395879","Nguyễn Ngọc Trường 0919010674","Phạm Minh Thắng 0935396298","Trần Đại Nhật 0838678789","Phạm Công Điện 0914666244","Đồng Minh Phương 0913457800","Nguyễn Văn Dũng 0942671717","Tú 0989862912","Khoa 0967829682","Lợi 0986418007","Quang 0915362184","Thọ 0949886204","Nam 0979985757","Danh 0979746633","Thành 0983267927","Hoài 0979881987","Toàn 0977428288","Nhân 0983087348","Thắng 0942962266","Hùng: 0975361275","Quyết 0345704595","Đạt 0919400992","Hòa 0976142577","Đức 0357669526","Thuận 0975613789","Trạm ALI 02343977080","Trạm CLO 02333731031","Trạm R7 02323675179","Trạm BSN 02323690606","Trạm HIEN 02353898208"];
/* Khởi tạo autocomplete cho các cột */
autocomplete(document.getElementById("Colum3"), Colum3);
autocomplete(document.getElementById("Colum4"), Colum4);
autocomplete(document.getElementById("Colum7"), Colum7);

</script>

<script>
//------------HÀM XUẤT FILE EXCEL - HÀM NÀY PHẢI ĐẶT TRƯỚC SORT BẢNG KHI XUẤT EXCEL-----------
// Function để export dữ liệu sang Excel
function exportToExcel() {
sortTable();
// Tạo workbook
const workbook = new ExcelJS.Workbook();
// Tạo sheet đầu tiên
const worksheet1 = workbook.addWorksheet("Sheet1");

// Lấy dữ liệu từ bảng và thêm vào sheet đầu tiên
const table = document.getElementById("mytable");
for (let row = 0; row < table.rows.length; row++) {
    const rowData = [];
    for (let col = 0; col < table.rows[row].cells.length; col++) {
        const cell = table.rows[row].cells[col];
        const cellValue = cell.innerText;
        rowData.push(cellValue);
    }
    worksheet1.addRow(rowData);
}

    // Merge các ô cùng giá trị trong cột thứ 2 (Ngày)
    const dateColumn = worksheet1.getColumn(2).values;
    let dateMergeStartIndex = 2;
    for (let i = 2; i <= dateColumn.length; i++) {
        if (i === dateColumn.length || dateColumn[i] !== dateColumn[i - 1]) {
            const dateMergeEndIndex = i - 1;
            if (dateMergeEndIndex > dateMergeStartIndex) {
                worksheet1.mergeCells(`B${dateMergeStartIndex}:B${dateMergeEndIndex}`);
                // Canh giữa các ô đã merge trong cột Ngày
                worksheet1.getCell(`B${dateMergeStartIndex}`).alignment = { horizontal: 'left', vertical: 'middle' };
            }
            dateMergeStartIndex = i;
        }
    }

    // Merge các ô cùng giá trị trong cột thứ 3 (Đài/Trạm) theo ngày
    const dateAndDaiTramMap = new Map();
    const maxRow = worksheet1.rowCount;
    for (let row = 4; row <= maxRow; row++) {
        const date = worksheet1.getCell(row, 2).value;
        const daiTram = worksheet1.getCell(row, 3).value;
        if (date && daiTram) {
            const key = `${date}-${daiTram}`;
            if (!dateAndDaiTramMap.has(key)) {
                dateAndDaiTramMap.set(key, { start: row, end: row });
            } else {
                dateAndDaiTramMap.get(key).end = row;
            }
        }
    }

    dateAndDaiTramMap.forEach((value) => {
        if (value.end > value.start) {
            worksheet1.mergeCells(`C${value.start}:C${value.end}`);
            // Canh giữa các ô đã merge trong cột Đài/Trạm
            worksheet1.getCell(`C${value.start}`).alignment = { horizontal: 'left', vertical: 'middle' };
        }
    });

    // Merge các ô tiêu đề và đặt in đậm
    const titleStyle = {
        font: { bold: true },
        alignment: { horizontal: 'center', vertical: 'middle' }
    };
    worksheet1.mergeCells("A1:I1");
    worksheet1.getCell("A1").style = titleStyle;
    worksheet1.mergeCells("E2:F2");
    worksheet1.getCell("E2").style = titleStyle;
    worksheet1.mergeCells("G2:H2");
    worksheet1.getCell("G2").style = titleStyle;

    // Đặt giá trị cho ô E2 G2 và canh giữa
    worksheet1.getCell('B2').value = '';
    worksheet1.getCell('C2').value = '';
    worksheet1.getCell('E2').value = 'Đơn vị thi công';
    worksheet1.getCell('E2').alignment = { horizontal: 'center', vertical: 'middle' };
    worksheet1.getCell('G2').value = 'Tuần tra/Giám sát';
    worksheet1.getCell('G2').alignment = { horizontal: 'center', vertical: 'middle' };
    // In đậm dòng tiêu đề thứ 3 từ A3 đến I3
    worksheet1.getRow(3).eachCell((cell) => {
        cell.font = { bold: true };
    });

    // Điều chỉnh độ rộng của cột
    worksheet1.getColumn(1).width = 5; // Cột A
    worksheet1.getColumn(2).width = 11; // Cột B
    worksheet1.getColumn(3).width = 11; // Cột C
    worksheet1.getColumn(4).width = 40; // Cột D
    worksheet1.getColumn(5).width = 20; // Cột E
    worksheet1.getColumn(6).width = 20; // Cột F
    worksheet1.getColumn(7).width = 20; // Cột G
    worksheet1.getColumn(8).width = 20; // Cột H
    worksheet1.getColumn(9).width = 40; // Cột I

    // Tô màu cột thứ 9 dựa trên nội dung
    worksheet1.eachRow({ includeEmpty: false }, function (row, rowNumber) {
        if (rowNumber > 3) { // Bỏ qua dòng tiêu đề
            const congViecCell = row.getCell(9); // Lấy ô Nội dung Công việc (cột thứ 9)
            const congViecValue = congViecCell.value;
            if (congViecValue.toLowerCase() !== "quét tuyến" && congViecValue.toLowerCase() !== "nghỉ" && congViecValue.toLowerCase() !== "Nội dung Công việc") {
                congViecCell.fill = {
                    type: 'pattern',
                    pattern: 'solid',
                    fgColor: { argb: 'FFFFFF00' } // Màu vàng
                };
            }
        }
    });

    // Thêm đường kẻ chỉ cho vùng có dữ liệu
    for (let row = 1; row <= maxRow; row++) {
        for (let col = 1; col <= 9; col++) {
            const cell = worksheet1.getCell(row, col);
            cell.border = {
                top: { style: 'thin' },
                left: { style: 'thin' },
                bottom: { style: 'thin' },
                right: { style: 'thin' },
            };
        }
    }

    // Canh giữa các ô từ A4 đến cuối cột C
    for (let row = 4; row <= maxRow; row++) {
        for (let col = 1; col <= 3; col++) { // Các cột từ A đến C
            const cell = worksheet1.getCell(row, col);
            cell.alignment = { vertical: 'middle' };
        }
    }

    // Canh trên các ô từ D4 đến cuối hết vùng dữ liệu cột I
    for (let row = 4; row <= maxRow; row++) {
        for (let col = 4; col <= 9; col++) { // Các cột từ D đến I
            const cell = worksheet1.getCell(row, col);
            cell.alignment = { vertical: 'top' };
        }
    }

    // Sử dụng tính năng wrap text cho các ô trong vùng dữ liệu từ E4 đến I4
    for (let row = 4; row <= maxRow; row++) {
        for (let col = 4; col <= 9; col++) { // Các cột từ D đến I
            const cell = worksheet1.getCell(row, col);
            cell.alignment = { wrapText: true, vertical: 'top' }; // Canh trên
        }
    }

	// Freeze panels từ dòng 4
	worksheet1.views = [
		{ state: 'frozen', xSplit: 0, ySplit: 3, topLeftCell: 'D4' }
	];

	//-- Thêm sheet "ĐT_HCM"---------	
	const worksheet2 = workbook.addWorksheet("ĐT_HCM");
		// Điều chỉnh độ rộng của cột
		worksheet2.getColumn(1).width = 5; // Cột A
		worksheet2.getColumn(2).width = 15; // Cột B
		worksheet2.getColumn(3).width = 15; // Cột C
		worksheet2.getColumn(4).width = 80; // Cột D
		// Freeze panels từ dòng 4
		worksheet2.views = [
			{ state: 'frozen', xSplit: 0, ySplit: 2 }
		];
		// Sử dụng tính năng wrap text cho các ô trong vùng dữ liệu từ E4 đến I4
		for (let row = 3; row <= maxRow; row++) {
			for (let col = 2; col <= 4; col++) { // Các cột từ D đến I
				const cell = worksheet2.getCell(row, col);
				cell.alignment = { wrapText: true, vertical: 'top' }; // Canh trên
			}
		}
		// Merge và định dạng tiêu đề A1 đến D1
	worksheet2.mergeCells("A1:D1");
	worksheet2.getCell("A1").value = "SỐ ĐIỆN THOẠI LIÊN HỆ CÁC TRẠM HCM - ĐÀI ĐHA";
	worksheet2.getCell("A1").alignment = { horizontal: 'center', vertical: 'middle' };
	worksheet2.getCell("A1").font = { bold: true };

	// Merge và định dạng tiêu đề A2
	worksheet2.mergeCells("A2");
	worksheet2.getCell("A2").value = "STT";
	worksheet2.getCell("A2").alignment = { horizontal: 'center', vertical: 'middle' };
	worksheet2.getCell("A2").font = { bold: true };

	// Merge và định dạng tiêu đề B2
	worksheet2.mergeCells("B2");
	worksheet2.getCell("B2").value = "Tên Trạm";
	worksheet2.getCell("B2").alignment = { horizontal: 'center', vertical: 'middle' };
	worksheet2.getCell("B2").font = { bold: true };

	// Merge và định dạng tiêu đề C2
	worksheet2.mergeCells("C2");
	worksheet2.getCell("C2").value = "Số ĐT bàn";
	worksheet2.getCell("C2").alignment = { horizontal: 'center', vertical: 'middle' };
	worksheet2.getCell("C2").font = { bold: true };

	// Merge và định dạng tiêu đề D2
	worksheet2.mergeCells("D2");
	worksheet2.getCell("D2").value = "Số ĐT Cá nhân";
	worksheet2.getCell("D2").alignment = { horizontal: 'center', vertical: 'middle' };
	worksheet2.getCell("D2").font = { bold: true };


	//----Số điện thoại-------------	
	worksheet2.getCell("B3").value = "Trạm A- Lưới";
	worksheet2.getCell("C3").value = "0234.3977080";
	worksheet2.getCell("D3").value = "Lợi 0986418007 (Trưởng trạm), Hoàng 0326012510, Tú 0989862912, Quang 0915362184, Thuận 0975613789; Bảo 0982467995; Kính 0988798370, Hiều 01666063656, Nhân 01656836784";

	worksheet2.getCell("B4").value = "Trạm Cam Lộ";
	worksheet2.getCell("C4").value = "0233.3731031";
	worksheet2.getCell("D4").value = "Thọ 0949.886204, 0988431753 (Trưởng trạm), Hòa 0963372301, Hoan 0967430122, Khoa 0967829682, Tiến 0981552594, Thượng 0965779488, Kính 0988798370, Nam 0979985757, Huy:0962465775, Cường 0364049298, Tú 0795789088, Đông 0973265809";

	worksheet2.getCell("B5").value = "Trạm R7";
	worksheet2.getCell("C5").value = "02323.675179";
	worksheet2.getCell("D5").value = "Công vụ 0975361275, Hùng 0973.608.595 (Trưởng trạm), Quyết 0345.704595, Hòa 0976142577, Đức 0357669526, Đạt 0919400992, Hiếu 0981223113, Tiến 0975361275";

	worksheet2.getCell("B6").value = "Trạm Bắc Sơn";
	worksheet2.getCell("C6").value = "02323.690606";
	worksheet2.getCell("D6").value = "Thành 0983267927, 0916 125345 (Trưởng trạm), Hoài 0979881987, 0832.182082, Toàn 0977428288, Hòa 0976142577, Tiến 0325715182";

	worksheet2.getCell("B7").value = "Trạm Hiên";
	worksheet2.getCell("C7").value = "02353898208";
	worksheet2.getCell("D7").value = "Nhân 0983087348 (Trưởng trạm), Tùng 0388715963, Thắng 0942962266, 0972055096; Ngô Tấn  Duy : Đại đội trưởng - Đại đội 6 : 0394243775";

	worksheet2.getCell("D8").value = "Khi các trạm HCM không có người trực cần tăng cường nhân lực báo A. Thông 096.4828648";
	worksheet2.getCell("D9").value = "Cáp Đài ĐHA nhận (ALI - HIEN) Ngày 15/04/2022. Từ  QC9/ALI Km343+163 - Km412+500(69.3Km) Trong đó: Trạm ALI(QC9) Quản lý (55,3km): QC9/ALI Km343+163 - Km398+500";
	worksheet2.getCell("D10").value = "Trạm HIEN (QC10) (Đài ĐNG) Quản lý giúp 14km : Từ Km398+500 - Km412+500";
	worksheet2.getCell("D11").value = "Trung: 0976099822: Trực thiết bị BTLTT;  Trực điều hành BTLTT HNI: 069558774, 069558775";

	// Lấy dòng cuối của cột D với dữ liệu trên sheet "ĐT_HCM"
	const lastDataRow = worksheet2.getColumn("D").values.length - 1;
	// Đánh số thứ tự cột A từ A3 đến dòng cuối có dữ liệu
	for (let row = 3; row <= lastDataRow; row++) {
		worksheet2.getCell(`A${row}`).value = row - 2;
		worksheet2.getCell(`A${row}`).alignment = { horizontal: 'center', vertical: 'middle' };
	}

	// Thêm đường kẻ chỉ cho vùng có dữ liệu
	for (let row = 1; row <= lastDataRow; row++) {
		for (let col = 1; col <= 4; col++) {
			const cell = worksheet2.getCell(row, col);
			cell.border = {
				top: { style: 'thin' },
				left: { style: 'thin' },
				bottom: { style: 'thin' },
				right: { style: 'thin' },
			};
		}
	}


	//-- End Thêm sheet "ĐT_HCM"---------	
	
// Tạo tên file với định dạng ngày hiện tại và tháng-năm của sheet
    var currentDate = new Date();
    currentDate.setDate(currentDate.getDate() + 1); // Thêm 1 ngày để lấy ngày hôm sau
    var formattedCurrentDate = ('0' + currentDate.getDate()).slice(-2) + '.' + ('0' + (currentDate.getMonth() + 1)).slice(-2) + '.' + currentDate.getFullYear();
    var fileName = 'DHA_Ke hoach tuan tra giam sat cap quang ngay ' + formattedCurrentDate  + '.xlsx';
	var sheetName = 'T' + ('0' + (currentDate.getMonth() + 1)).slice(-2) + '-' + currentDate.getFullYear(); // Tên sheet
	// Đặt tên cho sheet
    worksheet1.name = sheetName;
    // Xuất file Excel
    workbook.xlsx.writeBuffer().then(function (data) {
        const blob = new Blob([data], { type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = fileName; // Sử dụng tên file đã tạo
        a.click();
        URL.revokeObjectURL(url);
    });
		readDatattcqDHA_value();
}


// Gán sự kiện cho nút xuất Excel
document.getElementById("exportButton").addEventListener("click", function () {
    exportToExcel();
});
	
//--  SORT BẢNG TRƯỚC KHI XUẤT EXCEL---

// Hàm để chuyển định dạng ngày thành một đối tượng Date có thể so sánh
function parseDate(dateString) {
    const parts = dateString.split('/');
    const day = parseInt(parts[0], 10);
    const month = parseInt(parts[1], 10) - 1; // Lưu ý: Tháng trong đối tượng Date bắt đầu từ 0 (0 - 11)
    const year = parseInt(parts[2], 10);
    return new Date(year, month, day);
}

// Hàm để so sánh hai ngày
function compareDates(dateStringA, dateStringB) {
    const dateA = parseDate(dateStringA);
    const dateB = parseDate(dateStringB);
    return dateA - dateB;
}

// Hàm để sắp xếp bảng theo cột Ngày và Đài/Trạm
function sortTable() {
    const table = document.getElementById("mytable");
    const rows = Array.from(table.querySelectorAll("tr")).slice(3); // Bắt đầu từ dòng thứ tư

    rows.sort((a, b) => {
        const dateA = a.cells[1].textContent.trim(); // Lấy giá trị Ngày
        const dateB = b.cells[1].textContent.trim();
        const stationA = a.cells[2].textContent.trim(); // Lấy giá trị Đài/Trạm
        const stationB = b.cells[2].textContent.trim();

        // Sắp xếp theo cột Ngày sử dụng hàm so sánh compareDates
        if (dateA === dateB) {
            return stationA.localeCompare(stationB);
        } else {
            return compareDates(dateA, dateB);
        }
    });

    // Đánh lại số thứ tự cho mỗi hàng
    rows.forEach((row, index) => {
        row.cells[0].textContent = index + 1;
    });

    // Xóa nội dung cũ của bảng
    while (table.rows.length > 3) {
        table.deleteRow(3);
    }

    // Thêm lại các hàng đã sắp xếp
    rows.forEach((row) => {
        table.appendChild(row);
    });
}

// Gán sự kiện cho nút "Sắp xếp và đánh lại số thứ tự"
document.getElementById("sortAndRenumberButton").addEventListener("click", function () {
    sortTable();
    // Sau khi đánh lại số thứ tự, bạn có thể tiếp tục xuất dữ liệu sang Excel ở đây
});

//-- END SORT BẢNG TRƯỚC KHI XUẤT EXCEL---	
	

    </script>	


<script type="text/javascript">//<![CDATA[

!function(n){"use strict";n.fn.idle=function(e){var t,i,o={idle:6e4,events:"mousemove keydown mousedown touchstart",onIdle:function(){},onActive:function(){},onHide:function(){},onShow:function(){},keepTracking:!0,startAtIdle:!1,recurIdleCall:!1},c=e.startAtIdle||!1,d=!e.startAtIdle||!0,l=n.extend({},o,e),u=null;return n(this).on("idle:stop",{},function(){n(this).off(l.events),l.keepTracking=!1,t(u,l)}),t=function(n,e){return c&&(e.onActive.call(),c=!1),clearTimeout(n),e.keepTracking?i(e):void 0},i=function(n){var e,t=n.recurIdleCall?setInterval:setTimeout;return e=t(function(){c=!0,n.onIdle.call()},n.idle)},this.each(function(){u=i(l),n(this).on(l.events,function(){u=t(u,l)}),(l.onShow||l.onHide)&&n(document).on("visibilitychange webkitvisibilitychange mozvisibilitychange msvisibilitychange",function(){document.hidden||document.webkitHidden||document.mozHidden||document.msHidden?d&&(d=!1,l.onHide.call()):d||(d=!0,l.onShow.call())})})}}(jQuery);

$(document).idle({
  onIdle: function(){
	Search_dialog_time();
  },
  idle: 1800000
  //idle: 3600000
})
//]]>


var Thoat_timeme = document.getElementById("dialog_time");
var Thoatme = document.getElementById("testText");
function Search_dialog_time(){
if (document.getElementById("dialog_time")==null || document.getElementById("testText")==null) {
close();
} else {
show_dialog_time();
}
}


function show_dialog_time() {
    Thoat_timeme.style.display = "block";}
document.getElementById("confirm_time").onclick = function(){Thoatconfirm_value()};

// Thoát
document.getElementById("btn-show-dialog").onclick = function(){show_dialog()};
var Thoatme = document.getElementById("dialog-container");

function show_dialog() {
    Thoatme.style.display = "block";
}

document.getElementById("confirm").onclick = function(){Thoatconfirm_value()};

function Thoatconfirm_value() {	
 
	var ngaylog= $("#ngaylog").val();	
    var url = atob(script_url)+"?callback=ctrlq&ngaylog="+ngaylog +"&action=Thoatconfirm";	  
  
    var request = jQuery.ajax({
      crossDomain: true,
      url: url ,
      method: "GET",
      dataType: "jsonp"

	  });

	close();	
    Thoatme.style.display = "none";	
  }	


document.getElementById("cancel").onclick = function(){cancel()};
function cancel() {

    Thoatme.style.display = "none";
}


function close_window() {
	close();	
}
// ---------------------------


//OK--------
 
document.addEventListener('contextmenu', event => event.preventDefault());
history.pushState(null, null, document.URL);
window.addEventListener('popstate', function () {
    history.pushState(null, null, document.URL);
});

// Pagination

getPagination('#showData');

function getPagination(table) {
  var lastPage = 1;

  $('#maxRows')
    .on('change', function(evt) {

     lastPage = 1;
      $('.pagination')
        .find('li')
        .slice(1, -1)
        .remove();
      var trnum = 0;
      var maxRows = parseInt($(this).val());

      if (maxRows == 5000) {
        $('.pagination').hide();
      } else {
        $('.pagination').show();
      }

      var totalRows = $(table + ' tbody tr').length;
      $(table + ' tr:gt(2)').each(function() {                    // Thay số row
        trnum++;
        if (trnum > maxRows) {

          $(this).hide(); 
        }
        if (trnum <= maxRows) {
          $(this).show();
        } 
      }); 
      if (totalRows > maxRows) {

        var pagenum = Math.ceil(totalRows / maxRows); 

        for (var i = 1; i <= pagenum; ) {

          $('.pagination #prev')
            .before(
              '<li data-page="' +
                i +
                '">\
								  <span>' +
                i++ +
                '<span class="sr-only">(current)</span></span>\
								</li>'
            )
            .show();
        } 
      } 
      $('.pagination [data-page="1"]').addClass('active'); 
      $('.pagination li').on('click', function(evt) {

        evt.stopImmediatePropagation();
        evt.preventDefault();
        var pageNum = $(this).attr('data-page'); 

        var maxRows = parseInt($('#maxRows').val()); 

        if (pageNum == 'prev') {
          if (lastPage == 1) {
            return;
          }
          pageNum = --lastPage;
        }
        if (pageNum == 'next') {
          if (lastPage == $('.pagination li').length - 2) {
            return;
          }
          pageNum = ++lastPage;
        }

        lastPage = pageNum;
        var trIndex = 0; 
        $('.pagination li').removeClass('active'); 
        $('.pagination [data-page="' + lastPage + '"]').addClass('active'); 

	  	limitPagging();
        $(table + ' tr:gt(2)').each(function() {       // Thay số row

          trIndex++; 

          if (
            trIndex > maxRows * pageNum ||
            trIndex <= maxRows * pageNum - maxRows
          ) {
            $(this).hide();
          } else {
            $(this).show();
          } 
        }); 
      }); 
	  limitPagging();
    })
    .val(5)
    .change();

}

function limitPagging(){

	if($('.pagination li').length > 7 ){
			if( $('.pagination li.active').attr('data-page') <= 3 ){
			$('.pagination li:gt(5)').hide();
			$('.pagination li:lt(5)').show();
			$('.pagination [data-page="next"]').show();
		}if ($('.pagination li.active').attr('data-page') > 3){
			$('.pagination li:gt(0)').hide();
			$('.pagination [data-page="next"]').show();
			for( let i = ( parseInt($('.pagination li.active').attr('data-page'))  -2 )  ; i <= ( parseInt($('.pagination li.active').attr('data-page'))  + 2 ) ; i++ ){
				$('.pagination [data-page="'+i+'"]').show();

			}

		}
	}
}

$(function() {

  $('table tr:eq(0)').prepend('<th> STT </th>');

  var id = 0;

  $('table tr:gt(0)').each(function() {
    id++;
    $(this).prepend('<td>' + id + '</td>');
  });
});

// End Pagination


$(document).ready(function() {

Readtime_value();

 var url = location.protocol;

 if (url == "file:") {
	close();
		var element = document.getElementById("mytable");
		var element3 = document.getElementById("update");
		element.parentNode.removeChild(element);
		element.parentNode.removeChild(element3);
			
	} else {

	//==== Lịch ====
	$('.Colum2').datepicker({
          format: 'dd/mm/yyyy',
          autoclose: true,
          todayHighlight: true,
          language: 'vi'
        }).on('changeDate', function(e) {
          $('#Colum2').val(
            (e.date.getDate()<10 ? '0' : '') + e.date.getDate() + '/' +
            ((e.date.getMonth()+1)<10 ? '0' : '') + (e.date.getMonth()+1) + '/' +
            e.date.getFullYear()
          );
        });
			//====End Lịch ====
	}

});




// ----------------------

  function ctrlq(e) {

document.getElementById("ngay").value = e.result;
//alert(document.getElementById("ngay").value);
//alert(document.getElementById("combine").value);
let text = document.getElementById("ngay").value;
	if (text == "Quathoigian") {

			document.getElementById("id-container").style.display = "block";
			document.getElementById("id_alert").innerHTML = "Vui lòng thực hiện lại đăng nhập !";	

			document.getElementById("confirm_id").onclick = function(){confirm_id()};
			function confirm_id() {
				document.getElementById("id-container").style.display = "none";	
				close();
			}
	}

	if (text.indexOf("đã")> 0) {
			readDatattcqDHA_value();
			dialog_result.style.display = "block";
			document.getElementById("id_result").innerHTML = text;
			document.getElementById("id_result1").style.display = "block";
			document.getElementById("id_result2").style.display = "none";				

			} else if (text.indexOf("quyền") > 0 ) {
			dialog_result.style.display = "block";
			document.getElementById("id_result").innerHTML = text;
			document.getElementById("id_result1").style.display = "block";
			document.getElementById("id_result2").style.display = "none";
			
			} else if (text.indexOf("lòng") > 0 ) {
				dialog_result.style.display = "block";
				document.getElementById("id_result").innerHTML = text;
				document.getElementById("id_result1").style.display = "none";
				document.getElementById("id_result2").style.display = "block";
				
				close();
				
			} else {
  
	}


if (document.getElementById("ngay").value == "") {
	close();
 } else {
	 ChangeID();
}
	
	$("#re").html(e.result);
	$("#re").css("visibility","visible");

 }
	var Thoat_resultme1 = document.getElementById("dialog_result");
	document.getElementById("confirm_result1").onclick = function(){confirm_result1()};
	function confirm_result1() {		
		Thoat_resultme1.style.display = "none";		
	}

	var Thoat_resultme2 = document.getElementById("dialog_result"); 
	document.getElementById("confirm_result2").onclick = function(){confirm_result2()};
	function confirm_result2() {		
		Thoat_resultme2.style.display = "none";
			close();
	}
 
 
function Readtime_value() {
				// Lấy giá trị từ localStorage
	var idngaylog = localStorage.getItem('part2');
	//var idngaylog = "202308210906292134";	
				//alert(savedPart2); // Hiển thị giá trị đã lưu trữ trong localStorage
 
	var ngay= $("#ngay").val();	
    var url = atob(script_url)+"?callback=ctrlq&ngay="+ngay+ "&idngaylog=" + idngaylog +"&action=Readtime";	  
  
    var request = jQuery.ajax({
      crossDomain: true,
      url: url ,
      method: "GET",
      dataType: "jsonp"

	  });	
	localStorage.removeItem('part2');
}	

//-------------------Việt-------------------------------
(function() {
  if (window.addEventListener) {
    window.addEventListener('load', run, false);
  } else if (window.attachEvent) {
    window.attachEvent('onload', run);
  }

  function run() {
    var t = document.getElementById('showData');
    t.onclick = function(event) {
      event = event || window.event; //IE8
      var target = event.target || event.srcElement;
      while (target && target.nodeName != 'TR') { // find TR
        target = target.parentElement;
    }
      if (!target) { return; } 
      var cells = target.cells; 
      if (!cells.length) {
        return;
      }
	  if (cells[0].innerHTML =="" || cells[0].innerHTML == "KẾ HOẠCH TUẦN TRA GIÁM SÁT CÁP QUANG ĐÀI ĐHA" || cells[0].innerHTML == "STT") {
      var f1 = document.getElementById('id');
	  var f2 = document.getElementById('Colum2');
      var f3 = document.getElementById('Colum3');
      var f4 = document.getElementById('Colum4');
	  var f5 = document.getElementById('Colum5');
      var f6 = document.getElementById('Colum6');
      var f7 = document.getElementById('Colum7');
	  var f8 = document.getElementById('Colum8');
	  var f9 = document.getElementById('Colum9');
      f1.value = "";
      f2.value = "";
      f3.value = "";
      f4.value = "";
      f5.value = "";
      f6.value = "";
      f7.value = "";
      f8.value = "";
      f9.value = "";
	} else { 	  
      var f1 = document.getElementById('id');
	  var f2 = document.getElementById('Colum2');
      var f3 = document.getElementById('Colum3');
      var f4 = document.getElementById('Colum4');
	  var f5 = document.getElementById('Colum5');
      var f6 = document.getElementById('Colum6');
      var f7 = document.getElementById('Colum7');
	  var f8 = document.getElementById('Colum8');
	  var f9 = document.getElementById('Colum9');
	  
      f1.value = cells[0].innerHTML;
      f2.value = cells[1].innerHTML;
      f3.value = cells[2].innerHTML;
      f4.value = cells[3].innerHTML;
      f5.value = cells[4].innerHTML;
      f6.value = cells[5].innerHTML;
      f7.value = cells[6].innerHTML;
	  f8.value = cells[7].innerHTML;
      f9.value = cells[8].innerHTML;
	  
	  changecat(f10.value);
	  }
   };
 }

})();
 

	
window.onload = function(){

document.addEventListener('contextmenu', event => event.preventDefault());
history.pushState(null, null, document.URL);
window.addEventListener('popstate', function () {
    history.pushState(null, null, document.URL);
});

//window.history.replaceState('','','/');  
  
};
 

function readDatattcqDHA_value() {
    var ngaylog = $("#ngaylog").val();

	if (document.getElementById("combine").value == "") {		
			document.getElementById("id-container").style.display = "block";
			document.getElementById("id_alert").innerHTML = "Hãy đăng nhập !";	
			document.getElementById("confirm_id").onclick = function(){confirm_id()};
			function confirm_id() {
				document.getElementById("id-container").style.display = "none";	
			}
			return false;
	} else {

	$("#re").css("visibility","hidden");
	   
	   
	 var url = atob(script_url) + "?action=readttcqDHA&ngaylog=" + ngaylog; // Thêm tham số ngaylog vào URL để gửi lên Google Apps Script

	$.getJSON(url, function (json) {

			var table = document.createElement("table");
			
			table.setAttribute("id", "mytable");  // Add Class or id for table
			table.setAttribute("class", "sortable");  // Add Class or id for table
		
        for (var i = 0; i < json.records.length - 1; i++) {

            tr = table.insertRow(-1);
				var tabCell = tr.insertCell(-1);
				
                tabCell.innerHTML = json.records[i].ID;
				tabCell = tr.insertCell(-1);
				tabCell.innerHTML = json.records[i].Colum2 //TRAM;
				tabCell = tr.insertCell(-1);				
				tabCell.innerHTML = json.records[i].Colum3 //HE_THONG;
				tabCell = tr.insertCell(-1);				
				
				tabCell.innerHTML = json.records[i].Colum4 //THIET_BI;
				tabCell = tr.insertCell(-1);
				tabCell.innerHTML = json.records[i].Colum5 //TEN_VAT_TU;
				tabCell = tr.insertCell(-1);
				tabCell.innerHTML = json.records[i].Colum6 //LOAI_VAT_TU;
				tabCell = tr.insertCell(-1);				
				tabCell.innerHTML = json.records[i].Colum7 //PART_NUMBER;
				tabCell = tr.insertCell(-1);
				tabCell.innerHTML = json.records[i].Colum8 //SERIAL;
				tabCell = tr.insertCell(-1);				
				tabCell.innerHTML = json.records[i].Colum9 //NGAY_NHAN;

				
            }		
			
        var divContainer = document.getElementById("showData");
        divContainer.innerHTML = "";
        divContainer.appendChild(table);
	   
		$("#re").css("visibility","visible");
        // document.getElementById("mytable").align="center";
//		var thead = "<thead><tr> <th onclick='Sortcolunm(0)' style='font-weight:bold'>STT</th><th onclick='Sortcolunm(1)' style='font-weight:bold'>Ngày Tháng</th> <th onclick='Sortcolunm(2)' style='font-weight:bold'>Đài-Trạm</th> <th onclick='Sortcolunm(3)' style='font-weight:bold'>Tuyến cáp</th><th onclick='Sortcolunm(4)' style='font-weight:bold'>Đơn vị GT</th><th onclick='Sortcolunm(5)' style='font-weight:bold'>SĐT GT</th><th onclick='Sortcolunm(6)' style='font-weight:bold'>Tên người TTCQ</th> <th onclick='Sortcolunm(7)' style='font-weight:bold'>SĐT tuần tra</th>  <th onclick='Sortcolunm(8)' style='font-weight:bold'>Nội dung TTCQ</th>   </tr> </thead>"


var thead = "<thead> <tr>	<th colspan='9'>KẾ HOẠCH TUẦN TRA GIÁM SÁT CÁP QUANG ĐÀI ĐHA</th> </tr> <tr> <th colspan='4'></th> <th colspan='2'>Đơn vị thi công</th> <th colspan='2'>Tuần tra/Giám sát</th> <th> </th> </tr> <tr id='row3'> <th onclick='Sortcolunm(0)' >STT</th> <th onclick='Sortcolunm(1)' > Ngày </th> <th onclick='Sortcolunm(2)'> Đài/Trạm </th> <th onclick='Sortcolunm(3)' > Vị trí </th> <th onclick='Sortcolunm(4)' > Tên đơn vị </th> <th onclick='Sortcolunm(5)' > Số ĐT GT </th> <th onclick='Sortcolunm(6)' > Họ tên TTCQ </th> <th onclick='Sortcolunm(7)' > Số ĐT TTCQ </th> <th onclick='Sortcolunm(8)' > Nội dung công việc </th> </tr> </thead>"

//https://stackoverflow.com/questions/56947066/is-it-possible-to-create-a-sticky-table-header-with-multiple-rows-inside-it
//https://html.com/tables/rowspan-colspan/
		table.innerHTML = thead + table.innerHTML;
		

    });

	}
}
	
//-------------Nhắc lưu file vào ngày cuối tháng---------  
function checkAndShowReminder() {
  var combineValue = document.getElementById("combine").value;

  // Kiểm tra xem giá trị của "combine" có phải là "ttcqdha" không
  if (combineValue === "ttcqdha") {
    var currentDate = new Date();
    var lastDayOfMonth = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);
    lastDayOfMonth.setHours(20, 0, 0, 0); // Đặt giờ và phút cuối của ngày cuối tháng là 20 giờ

    var currentYear = currentDate.getFullYear();
    var currentMonth = currentDate.getMonth() + 1; // Tháng được đánh số từ 0 đến 11, nên cần cộng thêm 1
    var currentDay = currentDate.getDate();
    var currentHour = currentDate.getHours();

    var lastDayOfMonthYear = lastDayOfMonth.getFullYear();
    var lastDayOfMonthMonth = lastDayOfMonth.getMonth() + 1;
    var lastDayOfMonthDay = lastDayOfMonth.getDate();

    if (
      currentYear === lastDayOfMonthYear &&
      currentMonth === lastDayOfMonthMonth &&
      currentDay === lastDayOfMonthDay &&
      currentHour >= 7 && currentHour < 17
    ) {
      // Nếu thỏa mãn điều kiện thì hiển thị thông báo nhắc nhở
      //alert("Bạn hãy lưu lại file của tháng để tạo lại dữ liệu tháng mới");
	  
	  	document.getElementById("id-container").style.display = "block";
		  document.getElementById("id_alert").innerHTML = "Bạn hãy lưu lại file Excel tháng củ để chương trình tạo dữ liệu tháng mới";

		  document.getElementById("confirm_id").onclick = function() {
			confirm_id();
		  };

		  function confirm_id() {
			document.getElementById("id-container").style.display = "none";
		  }
	  
    }
  }
}
//-------------End Nhắc lưu file vào ngày cuối tháng--------- 	
	
	
function getPart1(str) {        // Lấy chuổi trái của "ngay"
    return str.split(' ')[0];
}
		
function getPart2(str) {        // Lấy chuổi phải của "ngay"
    return str.split(' ')[1];
}

function ChangeID() {
	document.getElementById("capnhatttcqDHA").value = getPart2(document.getElementById("ngay").value);   // Lấy chuổi phải của "ngay"
	// Đổi Value ngày: gán giá trị 'ngay' cho 'ngay2' sau dó đổi ngay2 thành 'ngaylog'
	if (document.getElementById('ngay2')) {
	document.getElementById("ngay2").value = getPart1(document.getElementById("ngay").value); // Lấy chuổi trái của "ngay"
	document.getElementById('ngay2').id = 'ngaylog';
	document.getElementById('capnhatttcqDHA').id = 'combine';

	//CheckNgaylog_value();

	if (document.getElementById("combine").value == "ttcqdha" && document.getElementById("combine").value !== ""  || document.getElementById("combine").value == "ttcqdhi" && document.getElementById("combine").value !== ""  || document.getElementById("combine").value == "ttcqhue" && document.getElementById("combine").value !== "" ) {
	document.getElementById('legend').innerHTML = "Cập nhật Lịch TTCQ ĐHA";
	readDatattcqDHA_value();
	checkAndShowReminder(); // Gọi hàm kiểm tra nhắc nhở lưu file cuối tháng
	}
			

	}
}



//var script_url = "aHR0cHM6Ly9zY3JpcHQuZ29vZ2xlLmNvbS9tYWNyb3Mvcy9BS2Z5Y2J4T0JWUEd3QTEwem0yX0laZmFvTmtwNlBZWUdTenpteDBCak9hQUlYSU9Yd09mV2NjYXJ5U3dRMnp1a2ltdEZTZC0vZXhlYw==";


//https://stackoverflow.com/questions/24804500/can-you-have-scrollbars-in-both-parallel-sides-of-a-div
$(function(){
      $(".HorizontalTable").scroll(function(){
        $(".sortable").scrollLeft($(".HorizontalTable").scrollLeft());
      });
      $(".sortable").scroll(function(){
        $(".HorizontalTable").scrollLeft($(".sortable").scrollLeft());
      });
});	


function Sortcolunm(n) {
  const table = document.getElementById("mytable");
  const rows = Array.from(table.rows).slice(3); // bỏ qua hàng 3 (header)
  const dir = table.dataset.sortDirection === "asc" ? 1 : -1;
  
  const collator = new Intl.Collator(undefined, {
    numeric: true,
    sensitivity: "base"
  });
  
  let sortFunction;
  const dataType = rows[0].cells[n].dataset.type;
  if (dataType === "number") {
    sortFunction = (a, b) => {
      const aVal = parseFloat(a.cells[n].textContent.replace(",", "."));
      const bVal = parseFloat(b.cells[n].textContent.replace(",", "."));
      return (aVal - bVal) * dir;
    };
  } else if (dataType === "date") {
    sortFunction = (a, b) => {
      const aDate = new Date(a.cells[n].textContent.trim());
      const bDate = new Date(b.cells[n].textContent.trim());
      return (aDate - bDate) * dir;
    };
  } else {
    sortFunction = (a, b) => collator.compare(a.cells[n].textContent, b.cells[n].textContent) * dir;
  }
  
  rows.sort(sortFunction);
  
  // xóa các hàng cũ và thêm hàng mới đã được sắp xếp vào bảng
  for (let i = 0; i < rows.length; i++) {
    table.appendChild(rows[i]);
  }
  
  // cập nhật trạng thái sắp xếp của bảng
  if (dir === 1) {
    table.dataset.sortDirection = "desc";
  } else {
    table.dataset.sortDirection = "asc";
  }
}

	
function searchTableWithHeader() {
  var input, filter, found, table, tr, td, i, j, count;
  input = document.getElementById("searchInput");
  filter = input.value.toUpperCase();
  table = document.getElementById("mytable");
  tr = table.getElementsByTagName("tr");
  count = 0; // khởi tạo số dòng tìm được
  for (i = 3; i < tr.length; i++) { // bắt đầu tìm từ dòng thứ 4
    td = tr[i].getElementsByTagName("td");
    if (td.length > 0) { // kiểm tra có phải là dòng dữ liệu hay không
      found = false; // khởi tạo biến found
      for (j = 0; j < td.length; j++) {
        if (td[j].innerHTML.toUpperCase().indexOf(filter) > -1) {
          found = true; // nếu tìm thấy, set found = true
          break;
        }
      }
      if (found) {
        tr[i].style.display = "";
        count++; // tăng số dòng tìm được lên 1
      } else {
        tr[i].style.display = "none";
      }
    }
  }

  document.getElementById('count').innerHTML = count; // hiển thị số dòng tìm được
}





//-----------------------UPDATE--------------------

document.getElementById("btn-show-update").onclick = function(){show_update()};
var Thoat_updateme = document.getElementById("update-container");

function show_update() {

	if (document.getElementById('id').value === "" || document.getElementById('id').value < 1) {
//	 alert("id OK"); Hãy chọn một id !
		Thoat_updateme.style.display = "none";
		document.getElementById("id-container").style.display = "block";
		document.getElementById("id_alert").innerHTML = "Hãy chọn một dòng để cập nhật !";	

		document.getElementById("confirm_id").onclick = function(){confirm_id()};
		function confirm_id() {
			document.getElementById("id-container").style.display = "none";	
		}
	
			return false;
	}

	Thoat_updateme.style.display = "block";

}


document.getElementById("confirm_update").onclick = function(){confirm_update()};
function confirm_update() {
  cancel_update();
  var combineValue = document.getElementById("combine").value;
  if (combineValue === "") {
    return false; // Thoát ngay nếu giá trị combine trống
  }

  var table = document.getElementById('mytable');
  var idToFind = document.getElementById('id').value; // Giá trị id cần tìm
  var rowIndex = findRowIndexById(table, idToFind);
  var row = table.rows[rowIndex];
//  alert('Dòng thứ ' + (rowIndex + 1) + ': ' + row.cells[2].innerText);
  
  if (row.cells[2].innerText !== "DHI" && combineValue === "ttcqdhi") {
    showErrorMessage(`Bạn không thể cập nhật số liệu của Trạm ${row.cells[2].innerText} !`);
    return false;
  } else if (row.cells[2].innerText !== "HUE" && combineValue === "ttcqhue") {
    showErrorMessage(`Bạn không thể cập nhật số liệu của Trạm ${row.cells[2].innerText} !`);
    return false;
  } else if ((row.cells[2].innerText === "DHI" || row.cells[2].innerText === "HUE") &&  combineValue === "ttcqdha") {
    showErrorMessage(`Bạn không thể cập nhật số liệu của Trạm ${row.cells[2].innerText} !`);
    return false;
  } else {
    updatettcqDHA_value();
  }
}

function showErrorMessage(message) {
  document.getElementById("id-container").style.display = "block";
  document.getElementById("id_alert").innerHTML = message;

  document.getElementById("confirm_id").onclick = function () {
    document.getElementById("id-container").style.display = "none";
  };
}

// Hàm để tìm vị trí dòng chứa giá trị id trong bảng
function findRowIndexById(table, id) {
  for (var i = 3; i < table.rows.length; i++) {
    var row = table.rows[i];
    if (row.cells[0].innerText.trim() === id) {
      return i; // Trả về chỉ số dòng (vị trí) nếu tìm thấy id
    }
  }
  return -1; // Trả về -1 nếu không tìm thấy id trong bảng
}



function confirm_update_Test() {
  Thoat_updateme.style.display = "none";

  var table = document.getElementById('mytable');
  var idToFind = document.getElementById('id').value; // Giá trị id cần tìm
  var rowIndex = findRowIndexById(table, idToFind);

  if (rowIndex === -1) {
    alert('Không tìm thấy id trong bảng!');
    return;
  }

  var row = table.rows[rowIndex];
  alert('Dòng thứ ' + (rowIndex + 1) + ': ' + row.cells[2].innerText);
}


document.getElementById("cancel_update").onclick = function(){cancel_update()};
function cancel_update() { 
    Thoat_updateme.style.display = "none";
}

//------------------INSERT-------------------
document.getElementById("btn-show-insert").onclick = function(){show_insert()};
var Thoat_insertme = document.getElementById("insert-container");

function show_insert() {
    Thoat_insertme.style.display = "block";
}


document.getElementById("confirm_insert").onclick = function(){confirm_insert()};
function confirm_insert() {

if (document.getElementById("combine").value == "ttcqdha" && document.getElementById("combine").value !== ""  || document.getElementById("combine").value == "ttcqdhi" && document.getElementById("combine").value !== ""  || document.getElementById("combine").value == "ttcqhue" && document.getElementById("combine").value !== "" ) {
	insertttcqDHA_value();
	//readDatattcqDHA_value();

} else {
		Thoat_insertme.style.display = "none";
  		document.getElementById("id-container").style.display = "block";
		document.getElementById("id_alert").innerHTML = "Chọn Trạm đang đăng nhập để thêm số liệu !";	

		document.getElementById("confirm_id").onclick = function(){confirm_id()};
		function confirm_id() {
			document.getElementById("id-container").style.display = "none";	
		}
		return false;
}	
Thoat_insertme.style.display = "none";    	
}

document.getElementById("cancel_insert").onclick = function(){cancel_insert()};
function cancel_insert() { 
    Thoat_insertme.style.display = "none";
}

//---DELETE---

document.getElementById("btn-show-delete").onclick = function(){show_delete()};
var Thoat_deleteme = document.getElementById("delete-container");

function show_delete() {

	if (document.getElementById('id').value === "" || document.getElementById('id').value < 1 ) {
	// alert("OK");
		Thoat_deleteme.style.display = "none";	
		document.getElementById("id-container").style.display = "block";
		document.getElementById("id_alert").innerHTML = "Hãy chọn một dòng muốn xóa !";	

		document.getElementById("confirm_id").onclick = function(){confirm_id()};
		function confirm_id() {
			document.getElementById("id-container").style.display = "none";	
		}

			return false;
	}
		Thoat_deleteme.style.display = "block";

}


document.getElementById("confirm_delete").onclick = function(){confirm_delete()};

function confirm_delete() {

  cancel_delete();
  var combineValue = document.getElementById("combine").value;
  if (combineValue === "") {
    return false; // Thoát ngay nếu giá trị combine trống
  }

  var table = document.getElementById('mytable');
  var idToFind = document.getElementById('id').value; // Giá trị id cần tìm
  var rowIndex = findRowIndexById(table, idToFind);
  var row = table.rows[rowIndex];
//  alert('Dòng thứ ' + (rowIndex + 1) + ': ' + row.cells[2].innerText);

  if (row.cells[2].innerText !== "DHI" && combineValue === "ttcqdhi") {
    showErrorMessage(`Bạn không thể Xóa số liệu của Trạm ${row.cells[2].innerText} !`);
    return false;
  } else if (row.cells[2].innerText !== "HUE" && combineValue === "ttcqhue") {
    showErrorMessage(`Bạn không thể Xóa số liệu của Trạm ${row.cells[2].innerText} !`);
    return false;
  } else if ((row.cells[2].innerText === "DHI" || row.cells[2].innerText === "HUE") &&  combineValue === "ttcqdha") {
    showErrorMessage(`Bạn không thể Xóa số liệu của Trạm ${row.cells[2].innerText} !`);
    return false;
  } else {
    deletettcqDHA_value();
  }
	
}

document.getElementById("cancel_delete").onclick = function(){cancel_delete()};
function cancel_delete() { 
    Thoat_deleteme.style.display = "none";
}

// THAY



	
function updatettcqDHA_value() {

  //==Kiểm tra nhập vào định dạng dd/mm/yyyy của Colum2 và Colum3======
  var input2 = document.getElementById("Colum2").value;
  var input3 = document.getElementById("Colum3").value;
  var Combi = document.getElementById("combine").value;
  var regex2 = /^\d{2}\/\d{2}\/\d{4}$/;
  var regex3 = /^DHI$/;
  var regex4 = /^HUE$/;
  var regex5 = /^(DHA|HIEN\(QC10\)|ALI\(QC9\)|CLO\(QC8\)|R7\(QC7\)|BSN\(QC6\))$/;

  if (regex2.test(input2)) {
    if (Combi === "ttcqdhi" && regex3.test(input3)) {
 //==End Kiểm tra nhập vào định dạng dd/mm/yyyy của Colum2 và Colum3======	
	
      $("#re").css("visibility", "hidden");
      document.getElementById("loader").style.visibility = "visible";

      var ngaylog = $("#ngaylog").val();
      var combine = $("#combine").val();
      var id = $("#id").val();
      var Colum2 = $("#Colum2").val();
      var Colum3 = $("#Colum3").val();
      var Colum4 = $("#Colum4").val();
      var Colum5 = $("#Colum5").val();
      var Colum6 = $("#Colum6").val();
      var Colum7 = $("#Colum7").val();
      var Colum8 = $("#Colum8").val();
      var Colum9 = $("#Colum9").val();

      var url = atob(script_url) + "?callback=ctrlq&id=" + id + "&Colum2=" + Colum2 + "&Colum3=" + Colum3 + "&Colum4=" + Colum4 + "&Colum5=" + Colum5 + "&Colum6=" + Colum6 + "&Colum7=" + Colum7 + "&Colum8=" + Colum8 + "&Colum9=" + Colum9 + "&ngaylog=" + ngaylog + "&combine=" + combine + "&action=updatettcqDHA";

      var request = jQuery.ajax({
        crossDomain: true,
        url: url,
        method: "GET",
        dataType: "jsonp"
      });
    } else if (Combi === "ttcqhue" && regex4.test(input3)) {
      $("#re").css("visibility", "hidden");
      document.getElementById("loader").style.visibility = "visible";

      var ngaylog = $("#ngaylog").val();
      var combine = $("#combine").val();
      var id = $("#id").val();
      var Colum2 = $("#Colum2").val();
      var Colum3 = $("#Colum3").val();
      var Colum4 = $("#Colum4").val();
      var Colum5 = $("#Colum5").val();
      var Colum6 = $("#Colum6").val();
      var Colum7 = $("#Colum7").val();
      var Colum8 = $("#Colum8").val();
      var Colum9 = $("#Colum9").val();

      var url = atob(script_url) + "?callback=ctrlq&id=" + id + "&Colum2=" + Colum2 + "&Colum3=" + Colum3 + "&Colum4=" + Colum4 + "&Colum5=" + Colum5 + "&Colum6=" + Colum6 + "&Colum7=" + Colum7 + "&Colum8=" + Colum8 + "&Colum9=" + Colum9 + "&ngaylog=" + ngaylog + "&combine=" + combine + "&action=updatettcqDHA";

      var request = jQuery.ajax({
        crossDomain: true,
        url: url,
        method: "GET",
        dataType: "jsonp"
      });
    } else if (Combi === "ttcqdha" && regex5.test(input3)) {
      $("#re").css("visibility", "hidden");
      document.getElementById("loader").style.visibility = "visible";

      var ngaylog = $("#ngaylog").val();
      var combine = $("#combine").val();
      var id = $("#id").val();
      var Colum2 = $("#Colum2").val();
      var Colum3 = $("#Colum3").val();
      var Colum4 = $("#Colum4").val();
      var Colum5 = $("#Colum5").val();
      var Colum6 = $("#Colum6").val();
      var Colum7 = $("#Colum7").val();
      var Colum8 = $("#Colum8").val();
      var Colum9 = $("#Colum9").val();

      var url = atob(script_url) + "?callback=ctrlq&id=" + id + "&Colum2=" + Colum2 + "&Colum3=" + Colum3 + "&Colum4=" + Colum4 + "&Colum5=" + Colum5 + "&Colum6=" + Colum6 + "&Colum7=" + Colum7 + "&Colum8=" + Colum8 + "&Colum9=" + Colum9 + "&ngaylog=" + ngaylog + "&combine=" + combine + "&action=updatettcqDHA";

      var request = jQuery.ajax({
        crossDomain: true,
        url: url,
        method: "GET",
        dataType: "jsonp"
      });

		  //==Kiểm tra nhập vào định dạng dd/mm/yyyy của Colum2 và Colum3======
		  } else {
		  Thoat_updateme.style.display = "none";
		  document.getElementById("id-container").style.display = "block";
		  document.getElementById("id_alert").innerHTML = "Kiểm tra lại Trạm chưa đúng !";

		  document.getElementById("confirm_id").onclick = function() {
			confirm_id();
		  };

		  function confirm_id() {
			document.getElementById("id-container").style.display = "none";
		  }

		  return false;
		}
	  } else {
		Thoat_updateme.style.display = "none";
		document.getElementById("id-container").style.display = "block";
		document.getElementById("id_alert").innerHTML = "Kiểm tra định dạng Ngày dd/mm/yyyy chưa đúng, hãy nhập lại!";

		document.getElementById("confirm_id").onclick = function() {
		  confirm_id();
		};

		function confirm_id() {
		  document.getElementById("id-container").style.display = "none";
		}

		return false;
	  }
	  //==End Kiểm tra nhập vào định dạng dd/mm/yyyy của Colum2 và Colum3======
  
  document.getElementById("id").value = "";
  document.getElementById("Colum2").value = "";
  document.getElementById("Colum3").value = "";
  document.getElementById("Colum4").value = "";
  document.getElementById("Colum5").value = "";
  document.getElementById("Colum6").value = "";
  document.getElementById("Colum7").value = "";
  document.getElementById("Colum8").value = "";
  document.getElementById("Colum9").value = "";

  //readDatattcqDHA_value();
}


  
function deletettcqDHA_value(){

//Kiểm tra định dạng dd/mm/yyyy của Colum2
//  var input = document.getElementById("Colum2").value;  
//  var regex = /^\d{2}\/\d{2}\/\d{4}$/;  
//  if (regex.test(input)) {
// alert("Định dạng ngày tháng hợp lệ!");
//End Kiểm tra định dạng dd/mm/yyyy của Colum2

  //Kiểm tra nhập vào định dạng dd/mm/yyyy của Colum2 và Colum3
  //var input2 = document.getElementById("Colum2").value;
  //var regex2 = /^\d{2}\/\d{2}\/\d{4}$/;
  
  var input3 = document.getElementById("Colum3").value;
  var Combi = document.getElementById("combine").value;

  var regex3 = /^DHI$/;
  var regex4 = /^HUE$/;
  var regex5 = /^(DHA|HIEN\(QC10\)|ALI\(QC9\)|CLO\(QC8\)|R7\(QC7\)|BSN\(QC6\))$/;

//  if (regex2.test(input2)) {
    if (Combi === "ttcqdhi" && regex3.test(input3)) {
//End Kiểm tra nhập vào Colum3

	$("#re").css("visibility","hidden");
     document.getElementById("loader").style.visibility = "visible";
	
	
	var ngaylog= $("#ngaylog").val();
	var combine= $("#combine").val();
	
	var id= $("#id").val();
	var Colum2= $("#Colum2").val();
	var Colum3= $("#Colum3").val();
	var Colum4= $("#Colum4").val();
	var Colum5= $("#Colum5").val();
	var Colum6= $("#Colum6").val();
	var Colum7= $("#Colum7").val();
	var Colum8= $("#Colum8").val();
	var Colum9= $("#Colum9").val();


    var url = atob(script_url)+"?callback=ctrlq&id="+id +"&Colum2="+Colum2  +"&Colum3="+Colum3+"&Colum4="+Colum4+"&Colum5="+Colum5+"&Colum6="+Colum6+"&Colum7="+Colum7+"&Colum8="+Colum8  +"&Colum9="+Colum9 +  "&ngaylog="+ngaylog+ "&combine="+combine+"&action=deletettcqDHA";
 

    var request = jQuery.ajax({
      crossDomain: true,
      url: url ,
      method: "GET",
      dataType: "jsonp"
	  
    });

	} else if (Combi === "ttcqhue" && regex4.test(input3)) {
 //End Kiểm tra nhập vào Colum3

	$("#re").css("visibility","hidden");
     document.getElementById("loader").style.visibility = "visible";
	
	
	var ngaylog= $("#ngaylog").val();
	var combine= $("#combine").val();
	
	var id= $("#id").val();
	var Colum2= $("#Colum2").val();
	var Colum3= $("#Colum3").val();
	var Colum4= $("#Colum4").val();
	var Colum5= $("#Colum5").val();
	var Colum6= $("#Colum6").val();
	var Colum7= $("#Colum7").val();
	var Colum8= $("#Colum8").val();
	var Colum9= $("#Colum9").val();


    var url = atob(script_url)+"?callback=ctrlq&id="+id +"&Colum2="+Colum2  +"&Colum3="+Colum3+"&Colum4="+Colum4+"&Colum5="+Colum5+"&Colum6="+Colum6+"&Colum7="+Colum7+"&Colum8="+Colum8  +"&Colum9="+Colum9 +  "&ngaylog="+ngaylog+ "&combine="+combine+"&action=deletettcqDHA";
 

    var request = jQuery.ajax({
      crossDomain: true,
      url: url ,
      method: "GET",
      dataType: "jsonp"
	  
    });	
	
   } else if (Combi === "ttcqdha" && regex5.test(input3)) {
 //End Kiểm tra nhập vào Colum3

	$("#re").css("visibility","hidden");
     document.getElementById("loader").style.visibility = "visible";
	
	
	var ngaylog= $("#ngaylog").val();
	var combine= $("#combine").val();
	
	var id= $("#id").val();
	var Colum2= $("#Colum2").val();
	var Colum3= $("#Colum3").val();
	var Colum4= $("#Colum4").val();
	var Colum5= $("#Colum5").val();
	var Colum6= $("#Colum6").val();
	var Colum7= $("#Colum7").val();
	var Colum8= $("#Colum8").val();
	var Colum9= $("#Colum9").val();


    var url = atob(script_url)+"?callback=ctrlq&id="+id +"&Colum2="+Colum2  +"&Colum3="+Colum3+"&Colum4="+Colum4+"&Colum5="+Colum5+"&Colum6="+Colum6+"&Colum7="+Colum7+"&Colum8="+Colum8  +"&Colum9="+Colum9 +  "&ngaylog="+ngaylog+ "&combine="+combine+"&action=deletettcqDHA";
 

    var request = jQuery.ajax({
      crossDomain: true,
      url: url ,
      method: "GET",
      dataType: "jsonp"
	  
    });	
	

//Kiểm tra nhập vào  Colum3
		  } else {
		  Thoat_updateme.style.display = "none";
		  document.getElementById("id-container").style.display = "block";
		  document.getElementById("id_alert").innerHTML = "Kiểm tra lại Trạm chưa đúng !";

		  document.getElementById("confirm_id").onclick = function() {
			confirm_id();
		  };

		  function confirm_id() {
			document.getElementById("id-container").style.display = "none";
		  }

		  return false;
		}

	  //End Kiểm tra nhập vào định dạng dd/mm/yyyy của Colum2 và Colum3
  
  document.getElementById("id").value = "";
  document.getElementById("Colum2").value = "";
  document.getElementById("Colum3").value = "";
  document.getElementById("Colum4").value = "";
  document.getElementById("Colum5").value = "";
  document.getElementById("Colum6").value = "";
  document.getElementById("Colum7").value = "";
  document.getElementById("Colum8").value = "";
  document.getElementById("Colum9").value = "";

  //readDatattcqDHA_value();
}
  

 
  
function insertttcqDHA_value(){

  //==Kiểm tra nhập vào định dạng dd/mm/yyyy của Colum2 và Colum3======
  var input2 = document.getElementById("Colum2").value;
  var input3 = document.getElementById("Colum3").value;
  var Combi = document.getElementById("combine").value;
  var regex2 = /^\d{2}\/\d{2}\/\d{4}$/;
  var regex3 = /^DHI$/;
  var regex4 = /^HUE$/;
  var regex5 = /^(DHA|HIEN\(QC10\)|ALI\(QC9\)|CLO\(QC8\)|R7\(QC7\)|BSN\(QC6\))$/;

  if (regex2.test(input2)) {
    if (Combi === "ttcqdhi" && regex3.test(input3)) {
 //==End Kiểm tra nhập vào định dạng dd/mm/yyyy của Colum2 và Colum3======	
	document.getElementById("Colum3").value = "DHI";
	$("#re").css("visibility","hidden");
     document.getElementById("loader").style.visibility = "visible";
	
	
	var ngaylog= $("#ngaylog").val();
	var combine= $("#combine").val();
	
	var id= $("#id").val();
	var Colum2= $("#Colum2").val();
	var Colum3= $("#Colum3").val();
	var Colum4= $("#Colum4").val();
	var Colum5= $("#Colum5").val();
	var Colum6= $("#Colum6").val();
	var Colum7= $("#Colum7").val();
	var Colum8= $("#Colum8").val();
	var Colum9= $("#Colum9").val();
	

    var url = atob(script_url)+"?callback=ctrlq&id="+id +"&Colum2="+Colum2  +"&Colum3="+Colum3+"&Colum4="+Colum4+"&Colum5="+Colum5+"&Colum6="+Colum6+"&Colum7="+Colum7+"&Colum8="+Colum8  +"&Colum9="+Colum9 +  "&ngaylog="+ngaylog+ "&combine="+combine+"&action=insertttcqDHA";
 

    var request = jQuery.ajax({
      crossDomain: true,
      url: url ,
      method: "GET",
      dataType: "jsonp"
	  
    });

    } else if (Combi === "ttcqhue" && regex4.test(input3)) {
 //==End Kiểm tra nhập vào định dạng dd/mm/yyyy của Colum2 và Colum3======	
	document.getElementById("Colum3").value = "HUE";
	$("#re").css("visibility","hidden");
     document.getElementById("loader").style.visibility = "visible";
	
	
	var ngaylog= $("#ngaylog").val();
	var combine= $("#combine").val();
	
	var id= $("#id").val();
	var Colum2= $("#Colum2").val();
	var Colum3= $("#Colum3").val();
	var Colum4= $("#Colum4").val();
	var Colum5= $("#Colum5").val();
	var Colum6= $("#Colum6").val();
	var Colum7= $("#Colum7").val();
	var Colum8= $("#Colum8").val();
	var Colum9= $("#Colum9").val();
	

    var url = atob(script_url)+"?callback=ctrlq&id="+id +"&Colum2="+Colum2  +"&Colum3="+Colum3+"&Colum4="+Colum4+"&Colum5="+Colum5+"&Colum6="+Colum6+"&Colum7="+Colum7+"&Colum8="+Colum8  +"&Colum9="+Colum9 +  "&ngaylog="+ngaylog+ "&combine="+combine+"&action=insertttcqDHA";
 

    var request = jQuery.ajax({
      crossDomain: true,
      url: url ,
      method: "GET",
      dataType: "jsonp"
	  
    });	
    } else if (Combi === "ttcqdha" && regex5.test(input3)) {
 //==End Kiểm tra nhập vào định dạng dd/mm/yyyy của Colum2 và Colum3======	

	$("#re").css("visibility","hidden");
     document.getElementById("loader").style.visibility = "visible";
	
	
	var ngaylog= $("#ngaylog").val();
	var combine= $("#combine").val();
	
	var id= $("#id").val();
	var Colum2= $("#Colum2").val();
	var Colum3= $("#Colum3").val();
	var Colum4= $("#Colum4").val();
	var Colum5= $("#Colum5").val();
	var Colum6= $("#Colum6").val();
	var Colum7= $("#Colum7").val();
	var Colum8= $("#Colum8").val();
	var Colum9= $("#Colum9").val();
	

    var url = atob(script_url)+"?callback=ctrlq&id="+id +"&Colum2="+Colum2  +"&Colum3="+Colum3+"&Colum4="+Colum4+"&Colum5="+Colum5+"&Colum6="+Colum6+"&Colum7="+Colum7+"&Colum8="+Colum8  +"&Colum9="+Colum9 +  "&ngaylog="+ngaylog+ "&combine="+combine+"&action=insertttcqDHA";
 

    var request = jQuery.ajax({
      crossDomain: true,
      url: url ,
      method: "GET",
      dataType: "jsonp"
	  
    });		
		  //==Kiểm tra nhập vào định dạng dd/mm/yyyy của Colum2 và Colum3======
		  } else {
		  Thoat_updateme.style.display = "none";
		  document.getElementById("id-container").style.display = "block";
		  document.getElementById("id_alert").innerHTML = "Kiểm tra lại Trạm chưa đúng !";

		  document.getElementById("confirm_id").onclick = function() {
			confirm_id();
		  };

		  function confirm_id() {
			document.getElementById("id-container").style.display = "none";
		  }

		  return false;
		}
	  } else {
		Thoat_updateme.style.display = "none";
		document.getElementById("id-container").style.display = "block";
		document.getElementById("id_alert").innerHTML = "Kiểm tra định dạng Ngày dd/mm/yyyy chưa đúng, hãy nhập lại!";

		document.getElementById("confirm_id").onclick = function() {
		  confirm_id();
		};

		function confirm_id() {
		  document.getElementById("id-container").style.display = "none";
		}

		return false;
	  }
	  //==End Kiểm tra nhập vào định dạng dd/mm/yyyy của Colum2 và Colum3======

	document.getElementById("id").value = "";
	document.getElementById("Colum2").value = "";
	document.getElementById("Colum3").value = "";
	document.getElementById("Colum4").value = "";
	document.getElementById("Colum5").value = "";
	document.getElementById("Colum6").value = "";
	document.getElementById("Colum7").value = "";
	document.getElementById("Colum8").value = "";
	document.getElementById("Colum9").value = "";
	//readDatattcqDHA_value();
  }



  
function searchTableAdmin() {
         	var totalOfFilter = 0;
           var input, filter, found, table, tr, td, i, j;
           input = document.getElementById("searchAdmin");
           filter = input.value.toUpperCase();
           table = document.getElementById("mytable");
           tr = table.getElementsByTagName("tr");
         
           for (i = 3; i < tr.length; i++) {
             td = tr[i].getElementsByTagName("td");
         	if (td[3].innerHTML.toUpperCase() == "ID"){found = true;} // Thay td = 3
             for (j = 3; j < td.length; j++) {
               if (td[j].innerHTML.toUpperCase().indexOf(filter) > -1) {
                 found = true;
               }
             }
         	
         
         	if (found) {
         		tr[i].style.display = "";
         		found = false;
         		
         		if(tr[i].getElementsByTagName("td")[6].innerHTML.toUpperCase() != "TỔNG.."){
         			totalOfFilter += parseInt(tr[i].getElementsByTagName("td")[6].innerHTML.toUpperCase());
         		}
         	} else {
         		tr[i].style.display = "none";
         	}
           }
         
           document.getElementById('totalOfFilter').innerHTML = totalOfFilter.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
           
           var mytable = document.getElementById("mytable");
           if (mytable) {
         	  var cls = mytable.getElementsByTagName("td");
         	  var sum = 0;
         	  for (var i = 3; i < cls.length; i++) {
         		// Here you check if it's a countable class and the parent tr's style is a visible tr
         		if (cls[i].className == "countable" && cls[i].closest("tr").style.display != "none") {
         		  sum += isNaN(cls[i].innerHTML) ? 0 : parseInt(cls[i].innerHTML);
         		}
         	  }
         	  //document.getElementById('total').innerHTML = sum;
           }
           
         }
         
         var mytable = document.getElementById("mytable");
         if (mytable) {
         	var cls = mytable.getElementsByTagName("td");
         	var sum = 0;
         	for (var i = 2; i < cls.length; i++) {
         	  if (cls[i].className == "countable") {
         		sum += isNaN(cls[i].innerHTML) ? 0 : parseInt(cls[i].innerHTML);
         	  }
         	}
         	document.getElementById('TỔNG..').innerHTML += sum;
         }



	
function filterTable_OK() { 
         	var totalOfFilter = 0;

  var input, filter, table, tr, td, i, txtValue, txtValue1, txtValue2, txtValue3, txtValue4, txtValue5, txtValue6;
  input = document.getElementById("Filter");
  filter1 = input.value.toUpperCase();
  table = document.getElementById("mytable");
  tr = table.getElementsByTagName("tr");
  for (i = 0; i < tr.length; i++) {
		td0 = tr[i].getElementsByTagName("td")[0];
		td1 = tr[i].getElementsByTagName("td")[1];
		td2 = tr[i].getElementsByTagName("td")[2];
		td3 = tr[i].getElementsByTagName("td")[3];
		td4 = tr[i].getElementsByTagName("td")[4];
		td5 = tr[i].getElementsByTagName("td")[5];
		td6 = tr[i].getElementsByTagName("td")[6];
    if (td0 || td1 || td2 || td3 || td4 || td5 || td6) {
			txtValue = td0.textContent || td0.innerText;
			txtValue1 = td1.textContent || td1.innerText;
			txtValue2 = td2.textContent || td2.innerText;
			txtValue3 = td3.textContent || td3.innerText;
			txtValue4 = td4.textContent || td4.innerText;
			txtValue5 = td5.textContent || td5.innerText;
			txtValue6 = td6.textContent || td6.innerText;
      if (txtValue.toUpperCase().indexOf(filter1) > -1 || txtValue1.toUpperCase().indexOf(filter1) > -1 || txtValue2.toUpperCase().indexOf(filter1) > -1 || txtValue3.toUpperCase().indexOf(filter1) > -1 || txtValue4.toUpperCase().indexOf(filter1) > -1 || txtValue5.toUpperCase().indexOf(filter1) > -1 || txtValue6.toUpperCase().indexOf(filter1) > -1 ) {
        tr[i].style.display = "";
		
		         		if(tr[i].getElementsByTagName("td")[6].innerHTML.toUpperCase() != "TỔNG.."){
         			totalOfFilter += parseInt(tr[i].getElementsByTagName("td")[6].innerHTML.toUpperCase());
         		}
		
      } else {
        tr[i].style.display = "none";
      }
    }       

  }
}



</script>


	
<div class="footer">

  <div class="footer-center col-md-4 col-sm-6">
    <div>
      <i class="fa fa-map-marker"></i>
      <p><span></span> Liên Hệ: 18 Trần Hưng Đạo<span> </span> Thành Phố Đông Hà, Tỉnh Quảng Trị</p>
    </div>
	<div>
      <i class="fa fa-phone"></i>
      <p> (02333) 855298</p>
      <p> (+84) 911393789</p>
    </div>
    <div>
      <i class="fa fa-envelope"></i>
      <p><a style="color:black;" href="mailto:tdnhat@vnpt.vn?subject = To Trưởng đài ĐHA">tdnhat@vnpt.vn</a></p>
    </div>
  </div>
  

 
  <div class="footer-right col-md-4 col-sm-6">

    <p class="menu">
	
      <a onclick="home()" > Trang Chủ</a> |
      <a href="#"> Website Đài Đông Hà</a> |
    </p>

    <p class="name"> Lê Văn Khanh Copyright © 2021. All right reserved.</p>
  </div>
</footer>
</div>

</body>
</html>
